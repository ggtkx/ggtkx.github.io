<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>2024 金谷拾月游园会电子地图</title>
    <script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script>
    <!-- 全局状态 通用函数 -->
    <script>
      const mapURL = `/images/2024-map/map.png`;
      const siteStates = {
        selectedLanguage: 'zh',
        isDrawerOpen: false,
        selectedTab: 'guide',
        qrCodeEle: undefined,
        hasPopupOpen: false,
      };

      function showBoothListPopupFunc(sectionName) {
        cuisinesListHTML = generateBoothListHTML(cuisinesList, sectionNames.cuisine);
        kidsListHTML = generateBoothListHTML(kidsList, sectionNames.kids);
        traditionsListHTML = generateBoothListHTML(traditionsList, sectionNames.traditions);
        functionsListHTML = generateBoothListHTML(functionsList, sectionNames.functions);

        if (sectionName === sectionNames.cuisine) {
          boothListEle.innerHTML = cuisinesListHTML;
          sectionNameEle.innerHTML = '美食区';
        } else if (sectionName === sectionNames.kids) {
          boothListEle.innerHTML = kidsListHTML;
          sectionNameEle.innerHTML = '儿童游戏区';
        } else if (sectionName === sectionNames.traditions) {
          boothListEle.innerHTML = traditionsListHTML;
          sectionNameEle.innerHTML = '传统区';
        } else if (sectionName === sectionNames.functions) {
          boothListEle.innerHTML = functionsListHTML;
          sectionNameEle.innerHTML = '功能 & 赞助区';
        }
        openPopup(boothListPopupEle);
        boothListEle.scrollTop = 0;
        document
          .querySelectorAll('.booth-card')
          .forEach((e) => e.addEventListener('click', openBoothDetails));
      }

      function closePopup(popupEle) {
        if (!popupEle) {
          return;
        }
        popupEle.classList.add('display-none');
        popupEle.classList.remove('display-block');
        siteStates.hasPopupOpen = false;
      }
      function openPopup(popupEle) {
        if (!popupEle) {
          return;
        }
        popupEle.classList.add('display-block');
        popupEle.classList.remove('display-none');
        siteStates.hasPopupOpen = true;
      }
    </script>

    <script type="text/javascript" src="https://blog.zgzg.io/custom/js/qrcode.js"></script>

    <!-- 赞助商信息及生成对应html -->
    <script>
      const sponsorsAndCollaboratorsMap = {
        HeCares: {
          name: 'HeCares',
          tier: 'collaborator',
          logo: '/images/2024-map/sponsors/友情合作-HeCares/友情合作-HeCares-logo.jpeg',
          qrCode: ['/images/2024-map/sponsors/友情合作-HeCares/HeCares-二维码.jpg'],
        },
        sjusv: {
          name: '交大校友会',
          tier: 'collaborator',
          logo: '/images/2024-map/sponsors/友情合作-交大校友会/友情合作-交大校友会-logo.png',
          qrCode: ['/images/2024-map/sponsors/友情合作-交大校友会/友情合作-交大校友会-二维码.png'],
        },
        chihuo: {
          name: '吃货小分队',
          tier: 'collaborator',
          logo: '/images/2024-map/sponsors/友情合作-吃货小分队/友情合作-吃货小分队logo.jpeg',
          qrCode: ['/images/2024-map/sponsors/友情合作-吃货小分队/友情合作-吃货-二维码.jpg'],
        },
        taiyangshen: {
          // 缺logo
          name: '太阳神美院',
          tier: 'collaborator',
          logo: '/images/2024-map/sponsors/友情合作-太阳神美院/Logo.PNG',
          qrCode: ['/images/2024-map/sponsors/友情合作-太阳神美院/QRcode.png'],
        },
        xigu: {
          name: '戏谷剧团',
          tier: 'collaborator',
          logo: '/images/2024-map/sponsors/友情合作-戏谷剧团/友情合作-戏谷剧团-logo.jpeg',
          qrCode: ['/images/2024-map/sponsors/友情合作-戏谷剧团/友情合作-戏谷剧团-二维码.png'],
        },
        tuokouxiu: {
          name: '硅谷脱口秀',
          tier: 'collaborator',
          logo: '/images/2024-map/sponsors/友情合作-硅谷脱口秀/硅谷脱口秀Logo新.png',
          qrCode: ['/images/2024-map/sponsors/友情合作-硅谷脱口秀/硅谷脱口秀二维码.png'],
        },
        aaya: {
          name: 'AAYA',
          tier: 'collaborator',
          logo: '/images/2024-map/sponsors/友情合作方-AAYA/AAYA-logo-中文.png',
          qrCode: ['/images/2024-map/sponsors/友情合作方-AAYA/二维码.jpg'],
        },
        berryfun: {
          name: 'BerryFun',
          tier: 'collaborator',
          logo: '/images/2024-map/sponsors/友情合作方-BerryFun/BerryFun-Logo带字-透明底.png',
          qrCode: ['/images/2024-map/sponsors/友情合作方-BerryFun/BerryFun小红书二维码.PNG'],
          details: `BerryFun是一个立足科学，以有趣为基础，与孩子们一起探索世界的户外自然教育机构。
<br/>
从2021到2024年暑期，BerryFun开展了39期不同主题的户外夏令营，内容涉及植物、中华文化、木工、美食、地质、观鸟、昆虫、电学、魔术、野外生存、服装设计、四大发明、古埃及古巴比伦文化等。
<br/>
孩子们在山野间追寻小鹿的足迹，寻找野兔的踪影。<br/>
在红木森林里且听风吟，投入自然怀抱。<br/>
在广袤天空看飞鸟翱翔，放飞无限想象。<br/>
在潺潺小溪里捉鱼摸虾，清凉整个夏天。<br/>
漫游中国城市雄伟工程，感中华文明之美。<br/>
在山脚公园里变身鲁班，体验造物的乐趣。<br/>
在湖光山色中制作美食，犒劳自己的味蕾。<br/>
在池塘蛙鸣中观察昆虫，感受生命的奇妙。<br/>
在岩层中探寻化石线索，解读地球的密码。<br/>
在博物馆里中穿越时空，邂逅古文化和古文明。<br/>
<br/>
在没有围栏的课堂里，孩子们恣意扩展想象力的边界。<br/>
在动手体验中，感受文化、科技与自然的魅力。<br/>
在蓝天白云青草地，度过一个美好的不插电童年。
`,
        },
        '99ranch': {
          name: '99大华',
          tier: 'platinum',
          logo: '/images/2024-map/sponsors/白金-99大华/白金-大华Logo.png',
          qrCode: ['/images/2024-map/sponsors/白金-99大华/白金-大华-二维码.png'],
          details: `下载大华APP，购齐生活所需！生鲜果蔬、生猛活海
鲜、零食饮料、美妆护肤，应有尽有！最快当天送达，
载歌在谷专享：全场订单满$68减$10，优惠码:<br/>
ZGZG10。10月万圣节大促：<br/>
10.18 - 10.31<br/>
10% OFF $60+<br/>
15% OFF $80+<br/>
20% OFF $100+，无需折扣码，自动满折。新人注册再送<br/>
减$20优惠券，活动当天去大华摊位可免费领取零食礼包！
`,
        },
        'balance-better': {
          name: 'Balance & Better',
          tier: 'platinum',
          logo: '/images/2024-map/sponsors/白金-Balance-Better/logo-Balance-Better.png',
          qrCode: [
            '/images/2024-map/sponsors/白金-Balance-Better/balanced-better-二维码及文字.png',
          ],
          details: `Are you a HENRY (High Earning Not Rich Yet)?
Are you bothered by high tax burden and wondering about tax-free plans?
Are you wondering about ways of passive income?
Are you wondering how to plan for a “worry-free” retirement?
Balanced & Better Financial Service Team is here to help. 

We are a team of financial professionals backed by 100+ accredited financial institutions. We provide holistic financial strategy education for families, facilitate solutions from kids college tuition funding, LTC (Long Term Care) preparation to retirement planning, estate planning etc.
We strive for professional excellence and Long-Term customer satisfaction.


WeChat ID:  BalancedBetter
Meet us: bit.ly/meet-BB
`,
        },
        juso: {
          name: 'JUSO Home',
          tier: 'platinum',
          logo: '/images/2024-map/sponsors/白金-JUSO/Juso_Home_logo-01.png',
          qrCode: [
            '/images/2024-map/sponsors/白金-JUSO/白金-JUSO-Home-二维码1.png',
            '/images/2024-map/sponsors/白金-JUSO/白金-JUSO-Home-二维码2.jpg',
          ],
          details: `Juso Home是一家总部坐落于旧金山湾区的家居用品的品牌。专注于打造现代、时尚且优质的家居体验。我们秉承让高端极简设计触手可及的理念，致力于提供亲民且可负担的高品质产品。欢迎您与我们一起，感受精致家居带来的温馨与品味。`,
        },
        lingoace: {
          name: 'Lingoace',
          tier: 'platinum',
          logo: '/images/2024-map/sponsors/白金-Lingoace/白金-Lingoace-logo.jpeg',
          qrCode: ['/images/2024-map/sponsors/白金-Lingoace/白金-lingoace-二维码.png'],
          details: `LingoAce 是一家专注于为全球学生提供中文学习的在线教育平台，特别适合3到15岁的儿童。通过结合互动性强的课程设计、丰富多样的教材和资深教师团队，LingoAce 为儿童创造了一种沉浸式的语言学习环境。平台提供个性化的学习体验，帮助孩子们通过趣味性强的方式掌握中文听、说、读、写的技能。

LingoAce 的教学方式以寓教于乐为核心理念，结合游戏化的互动和多媒体资源，激发孩子们的学习兴趣。平台上的教师均为经过严格筛选和专业培训的母语教师，确保学生得到高质量的教学指导。此外，LingoAce 还提供详细的学习报告，帮助家长及时了解孩子的进步情况。

平台的课程设置灵活，家长可以根据孩子的需求和水平自由选择课程，满足不同语言学习目标的需求。无论是初学者还是有一定基础的学生，LingoAce 都致力于为全球儿童提供高效、有趣的中文学习体验。
`,
        },
        tradeup: {
          name: 'TradeUP 老虎证券',
          tier: 'platinum',
          logo: '/images/2024-map/sponsors/白金-TradeUP/白金-老虎证券logo.jpeg',
          qrCode: ['/images/2024-map/sponsors/白金-TradeUP/老虎证券二维码.jpeg'],
          details: `TradeUP Securities, Inc.是老虎证券（Nasdaq: TIGR)在美国挂牌营业、有清算资质的证券公司，专注于为全球客户提供迅捷、高质量的证券交易执行、证券清算和全方位金融投资服务。

TradeUP成立于1986年，拥有逾30年的经验，秉承可靠、专业的全球化服务标准，已成为诸多国际零售及机构客户值得信赖的投资伙伴。我们受美国SEC监管，也是FINRA、NYSE、SIPC的会员。

TradeUp is a Nasdaq-listed fintech company that can support your investments with a professional trading system, educational content, and analysis.
`,
        },
        fangtai: {
          name: '方太',
          tier: 'platinum',
          logo: '/images/2024-map/sponsors/白金-方太/白金-FOTILE方太-logo-black.png',
          qrCode: [
            '/images/2024-map/sponsors/白金-方太/白金-方太-Cupertino二维码.jpg',
            '/images/2024-map/sponsors/白金-方太/白金-方太-Milpitas二维码.jpg',
            '/images/2024-map/sponsors/白金-方太/白金-方太-UnionCity二维码.jpg',
          ],
          details: `方太近30年来始终致力于通过技术创新，为用户打造更健康幸福的厨房生活。2017年，方太进军美国市场，专为美国更开放宽敞的厨房设计了一系列高端厨电产品，赢得了广大用户的信赖与好评。目前，美国核心城市中每三户华人家庭，就有一户选择方太。凭借强大的实力和卓越的品质，方太连续三年被福布斯评选为“十佳油烟机品牌”，成为唯一上榜的中国出海品牌。`,
        },
        fantuan: {
          name: '饭团',
          tier: 'platinum',
          logo: '/images/2024-map/sponsors/白金-饭团/白金-饭团-logo.png',
          qrCode: ['/images/2024-map/sponsors/白金-饭团/白金-饭团-二维码.png'],
          details: `饭团外卖结合了湾区好吃的好玩的，从【外卖配送】到【生鲜便利】到【到店团购】等多样化服务, 不断开拓业务边界, 帮助用户更好地探索湾区本地生活。为海外华人及所有海外消费者提供更加便捷, 高效, 智能的服务。
现在新人用户还有$100大礼包优惠券。全场独家超值折扣美食、娱乐，让大家感受到家的味道家的温暖，真正做到“轻松生活, 一个饭团就够了”
`,
        },
        ipg: {
          name: 'IPG',
          tier: 'gold',
          logo: '/images/2024-map/sponsors/黄金-IPG/logo.jpg',
          qrCode: ['/images/2024-map/sponsors/黄金-IPG/微信公众号二维码.png'],
          details: `英特利普集团成立于硅谷，专注全球招雇一体化，集团总部位于硅谷，在纽约、伦敦、新加坡、上海、北京、深圳等全球15个核心城市设有分公司。AI人才库11亿，覆盖160+国家，为顶级科技公司提供招聘与雇佣服务，致力于AI驱动的人才匹配。`,
        },
        steve: {
          name: 'Steve Chen',
          tier: 'gold',
          logo: '/images/2024-map/sponsors/黄金-Steve/金牌-Steve-Chen-logo.jpeg',
          qrCode: ['/images/2024-map/sponsors/黄金-Steve/金牌-Steve-Chen-二维码.jpeg'],
          details: `Steve Chen，从业15年的资深房屋贷款经纪。顶尖的团队，凭藉扎实专业知识、丰富沟通技巧、和多年的实战经验，帮助了超过5000个家庭在美国完成购屋的梦想！`,
        },
        hanfushe: {
          name: 'hanfushe',
          tier: 'collaborator',
          logo: '/images/2024-map/sponsors/友情合作-硅谷汉服社/logo.jpg',
          qrCode: [
            '/images/2024-map/sponsors/友情合作-硅谷汉服社/logo简介.jpg',
            '/images/2024-map/sponsors/友情合作-硅谷汉服社/二维码.jpg',
          ],
          details: '',
        },
      };
      const collaboratorsList = [
        'HeCares',
        'sjusv',
        'chihuo',
        'taiyangshen',
        'xigu',
        'tuokouxiu',
        'aaya',
        'berryfun',
        'hanfushe',
      ];
      const sponsorsList = [
        '99ranch',
        'balance-better',
        'juso',
        'lingoace',
        'tradeup',
        'fangtai',
        'fantuan',
        'ipg',
        'steve',
      ];

      const sponsorsIndex = [
        'HeCares',
        'sjusv',
        'chihuo',
        'taiyangshen',
        'xigu',
        'tuokouxiu',
        'aaya',
        'berryfun',
        '99ranch',
        'balance-better',
        'juso',
        'lingoace',
        'tradeup',
        'fangtai',
        'fantuan',
        'ipg',
        'steve',
      ];

      const sponsorsListHTML = sponsorsList
        .map((sponsor, i) => {
          const info = sponsorsAndCollaboratorsMap[sponsor];
          return `
  <div class="sponsor-logo tier-${info.tier}" data-sponsor="${sponsor}">
    <img class="tire-icon" src="/images/2024-map/icon-${info.tier}.png" alt="" />
    <input class="active-selected-sponsor" name="selected-sponsor" type="radio" ${
      i === 0 ? 'checked' : ''
    } />
    <div class="logo-container">
    <img data-sponsor="${sponsor}"
      tabindex="0"
      class="logo-img"
      src="${info.logo}"
      alt="${info.name}"
    />
    </div>
  </div>
  `;
        })
        .join('');

      const collaboratorsListHTML = collaboratorsList
        .map((sponsor, i) => {
          const info = sponsorsAndCollaboratorsMap[sponsor];
          return `
  <div class="sponsor-logo tier-collaborator" data-sponsor="${sponsor}">
    <input class="active-selected-sponsor" name="selected-sponsor" type="radio" ${
      i === 0 ? 'checked' : ''
    } />
    <div  class="logo-container">
    <img
    data-sponsor="${sponsor}"
      class="logo-img"
      src="${info.logo}"
      alt="${info.name}"
    />
    </div>
  </div>
  `;
        })
        .join('');
    </script>

    <!-- 摊位信息及生成对应 html -->
    <script>
      const sectionNames = {
        cuisine: 'cuisine',
        kids: 'kids',
        traditions: 'traditions',
        functions: 'functions',
      };
      const cuisinesList = [
        {
          stampIndex: 'cuisine-1',
          sectionIndexes: [1],
          name: '巴九门烧烤',
          nameEng: '3 kingdoms BBQ',
          checkin: false,
        },
        {
          stampIndex: 'cuisine-2',
          sectionIndexes: [2],
          name: '甘了蔗杯',
          nameEng: 'Sugarcane Cup ',
          checkin: true,
          checkinCondition: {
            cn: `购买3件商品以上`,
            en: `Purchase more than 3 items`,
          },
          details: {
            en: `Fresh squeezed sugarcane juice always bring fresh , sweet , nutrition .  `,
          },
        },
        {
          stampIndex: 'cuisine-3',
          sectionIndexes: [3],
          name: '沙县小吃',
          nameEng: 'Taste of sha xian',
          checkin: true,
          checkinCondition: {
            cn: `消费满30`,
            en: `Spend more than $30`,
          },
          details: {
            cn: `国民小吃，在中国家喻户晓的沙县小吃`,
          },
        },
        {
          stampIndex: 'cuisine-4',
          sectionIndexes: [4],
          name: 'HE&C Tea + Pot',
          nameEng: 'HE&C Tea + Pot',
          checkin: true,
          checkinCondition: {
            cn: `购买3件商品以上`,
            en: `Purchase more than 3 items`,
          },
          details: {
            en: `He& C believes that a cup of tea not only letting us enjoy the symbolic taste but also giving us a quiet and peaceful atmosphere of respect. This calm and peaceful cup helps relieve stress and fatigue. HE&C is fully committed to using the best tea to serve our community and find a beautiful balance in our life.`,
          },
        },
        {
          stampIndex: 'cuisine-5',
          sectionIndexes: [5],
          name: '书亦烧仙草',
          nameEng: 'Shuyi Grass Jelly& Tea',
          checkin: false,
          details: {
            cn: `书亦烧仙草（Shuyi Grass Jelly & Tea）是一个源自中国的知名茶饮品牌，以传统的烧仙草和创新茶饮为核心产品，深受消费者喜爱。其品牌理念是传承传统茶文化，同时通过创新的方式融入现代元素，打造出具有独特风味和健康特色的饮品。书亦烧仙草不仅注重产品的口感和品质，还注重选用高品质的原材料，如新鲜水果、优质茶叶和天然食材。`,
          },
        },
        {
          stampIndex: 'cuisine-6',
          sectionIndexes: [6],
          name: '貂炸天',
          nameEng: 'Fantasy Asian Street Food, Inc.',
          checkin: true,
          checkinCondition: {
            cn: `消费满30`,
            en: `Spend more than $30`,
          },
        },
        {
          stampIndex: 'cuisine-7',
          sectionIndexes: [7],
          name: '士林台湾小吃',
          nameEng: 'Shihlin Taiwan Street Snacks',
          checkin: true,
          checkinCondition: {
            cn: `消费满30`,
            en: `Spend more than $30`,
          },
        },
        {
          stampIndex: 'cuisine-8',
          sectionIndexes: [8],
          name: 'CAFÉ KAZKA',
          nameEng: 'CAFÉ KAZKA',
          checkin: true,
          checkinCondition: {
            cn: `购买3件商品以上`,
            en: `Purchase more than 3 items`,
          },
          details: {
            en: `Welcome to CAFÉ KAZKA, a local business run by a young married couple. They met each other back in 2015 when a barista job opened in San Francisco. Both of them were passionate about making and creating unique drinks. They've been working in this industry for quite some time and wanted to bring something new and fun to the market. In January 2021, KAZKA was born. The name "KAZKA" symbolizes the sound of happiness when opening a fizzy can. We are so grateful for your continued support, and now we can tell you that we will open a store in Foster City soon. Our owner is a native of Hong Kong; he loves the place where he grew up and, of course, the local food. Inspired by Hong Kong's cafes, we've meticulously designed special and fusion delicacies to match our signature drinks. Come to Cafe KAZKA, where delicious food and one-of-a-kind drinks delight your taste buds. See you in Foster City!`,
          },
        },

        {
          stampIndex: 'cuisine-9',
          sectionIndexes: [9],
          name: '富贵柠手打柠檬茶',
          nameEng: 'Rich Lemon Tea',
          checkin: true,
          checkinCondition: {
            cn: `消费满30`,
            en: `Spend more than $30`,
          },
        },

        {
          stampIndex: 'cuisine-10',
          sectionIndexes: [10],
          name: '99 Ranch Market 大華線上超市',
          checkin: true,
          checkinCondition: {
            cn: `消费满30`,
            en: `Spend more than $30`,
          },
          details: {
            cn: `99 Ranch Market 大華線上超市：
大华摊位零食大放送！下载大华APP，各种零食礼包、超值优惠券免费拿！新人再赠送减$20优惠券。数量有限，先到先得！`,
          },
        },
      ];
      const kidsList = [
        {
          stampIndex: 'kids-1',
          sectionIndexes: [1],
          name: '跃动天地',
          nameEng: 'Mini Sports Games',
          checkin: true,
          free: true,
          checkinCondition: {
            html: `
                <div style="text-align: start;">
                  <ul>
                    <li>
                      [Diabolo]
                      <ul>
                        <li>For 13 and under: Play the diablo continuously for 10 seconds</li>
                        <li>For 14 and above: Play the diablo continuously for 20 seconds</li>
                      </ul>
                    </li>
                    <li>
                      [Pitch Pot]
                      <ul>
                        <li>For all age range: Make 2 or more out of 10 total attempts</li>
                      </ul>
                    </li>
                    <li>
                      [Jianzi]
                      <ul>
                        <li>For 13 and under: Get 3 in a row without dropping</li>
                        <li>For 14 and above: Get 5 in a row without dropping</li>
                      </ul>
                    </li>
                    <li>
                      [Jump Rope]
                      <ul>
                        <li>For 13 and under: Do 20 continuously without tripping</li>
                        <li>For 14 and above: Do 30</li>
                      </ul>
                    </li>
                  </ul>
                </div>
                  `,
          },
          details: {
            cn: `通过完成抖空竹，投壶，踢键子，或者跳绳，来获取活动徽章！`,
            en: `Get a stamp by Diabolo, Pitch Pot, Jianzi, or rope jumping! `,
          },
        },
        {
          stampIndex: 'kids-2',
          sectionIndexes: [2],
          name: '叠叠乐',
          nameEng: 'Jenga',
          checkin: true,
          checkinCondition: {
            cn: `完成摊位活动`,
            en: `Complete booth activities`,
          },
          free: true,
          details: {
            cn: `由玩家轮流将下方的积木抽出，堆叠到塔的最上层。 积木塔倒塌即为游戏结束，最后移动积木的玩家为输。`,
            en: `Take one block on a turn from any level of the tower (except the one below an incomplete top level), and place it on the topmost level in order to complete it. The game ends when the tower falls -- completely or if any block falls from the tower (other than the block a player moves on a turn).`,
          },
        },
        {
          stampIndex: 'kids-3',
          sectionIndexes: [3],
          name: '钓鱼',
          nameEng: 'Fishing Game',
          checkin: true,
          free: true,
          checkinCondition: {
            cn: `完成摊位活动`,
            en: `Complete booth activities`,
          },
          details: {
            cn: `儿童钓鱼小游戏。`,
            en: `Fishing Game for children. `,
          },
        },
        {
          stampIndex: 'kids-4',
          sectionIndexes: [4],
          name: 'Silicon Valley Youth',
          nameEng: 'Silicon Valley Youth',
          checkin: true,
          checkinCondition: {
            cn: `完成摊位活动`,
            en: `Complete booth activities`,
          },
          price: '$3',
          includedInTicket: true,
          details: {
            en: `【组织介绍】<br/>
      Silicon Valley Youth is a student-run nonprofit educational and community service organization under the provisions of section 501(c)(3) of the Internal Revenue Code.<br/>
      Our mission is to develop the intellectual, moral, civic, and creative capabilities of youth so they can serve and lead our society.<br/>
      Silicon Valley Youth is an official certifying organization for the President's Volunteer Service Award.<br/>
      All profits go toward supporting education and creating equal opportunities for all students.`,
            cn: `【摊位活动】<br/>
      1. 投壺遊戲：轮流将箭杆投抛至酒壶内<br/>
      2. 有奖问答游戏：競答不同类型的题目換獎品`,
          },
        },
        {
          stampIndex: 'kids-5',
          sectionIndexes: [5],
          name: '百变气球',
          nameEng: `Balloons Twisting`,
          checkin: true,
          checkinCondition: {
            cn: `完成摊位活动`,
            en: `Complete booth activities`,
          },
          price: '$3',
          includedInTicket: true,
          details: {
            cn: `一起来制作形状百变的气球吧！`,
            en: `Let's twist balloons to inspire your creativity! `,
          },
        },
        {
          stampIndex: 'kids-6',
          sectionIndexes: [6],
          name: 'BerryFun自制徽章',
          nameEng: 'DIY Badge provided by BerryFun',
          checkin: true,
          checkinCondition: {
            cn: `完成摊位活动`,
            en: `Complete booth activities`,
          },
          price: '$3',
          includedInTicket: true,
          details: {
            cn: `一起来制作独属于你的徽章吧！
            BerryFun是一个立足科学，以有趣为基础，与孩子们一起探索世界的户外自然教育非营利组织。`,
            en: `DIY your unique badge here! 
            "BerryFun" is a nonprofit outdoor nature education organization that is grounded in science and emphasizes fun as a foundation while exploring the world with children.`,
          },
        },
        {
          stampIndex: 'kids-7',
          sectionIndexes: [7],
          name: '漆扇',
          nameEng: 'Paintable Fan',
          checkin: true,
          checkinCondition: {
            cn: `完成摊位活动`,
            en: `Complete booth activities`,
          },
          price: '$6',
          includedInTicket: true,
          details: {
            cn: `以漆为笔，以水为墨，具有绝美东方色彩的“漆扇”也由此而生，漆扇，以扇子为载体，运用国家级非遗漆染工艺手工染制而成的艺术品。载歌在谷漆扇铺子将帮助每一位顾客制作完成属于自己的，独一无二的扇子。
      漆扇的主题将在不同时段提供：荷塘月色，菜籽花田，紫气东来，十里芳菲，落日晚霞，蓝色星球，阿勒泰等色系。`,
            en: `Use lacquer as the brush and water as the ink to create your own lacquer fan artwork! Themes for the lacquer fans will be offered at different times, including: 'Lotus Pond Under Moonlight,' 'Rapeseed Flower Field,' 'Purple Aura From the East,' 'Ten Miles of Fragrance,' 'Sunset Glow,' 'Blue Planet,' and 'Altay,' among others.`,
          },
        },
        {
          stampIndex: 'kids-8',
          sectionIndexes: [8],
          name: '万花筒',
          nameEng: 'DIY Kaleidoscope',
          checkin: true,
          checkinCondition: {
            cn: `完成摊位活动`,
            en: `Complete booth activities`,
          },
          price: '$3',
          includedInTicket: true,
          details: {
            cn: `万花筒DIY制作，工作人员提供材料和指导，快来制作属于自己独一无二的万花筒吧！`,
            en: `Let's DIY your unique Kaleidoscope together! `,
          },
        },
        {
          stampIndex: 'kids-9',
          sectionIndexes: [9],
          name: '闪亮画艺坊',
          nameEng: 'Shining Painting Studio',
          checkin: true,
          checkinCondition: {
            cn: `完成摊位活动`,
            en: `Complete booth activities`,
          },
          price: '钻石画$3，刮画$0',
          includedInTicket: true,
          details: {
            cn: `闪亮画艺坊专门为您提供美丽闪耀的钻石贴画和炫彩刮画纸。无论是儿童、还是喜欢DIY的成人，在我们的店铺都能体验创作的乐趣和成就感。`,
            en: `DIY diamond paintings by sticking small resin 'diamonds' onto a canvas to create a mosaic-like picture. Or DIY a colorful scratch art painting by scratching off black coating to reveal colorful patterns underneath. `,
          },
        },
        {
          stampIndex: 'kids-10',
          sectionIndexes: [10],
          name: '活字印刷',
          nameEng: 'Movable Type Printing',
          checkin: true,
          free: true,
          checkinCondition: {
            cn: `完成摊位活动`,
            en: `Complete booth activities`,
          },
          includedInTicket: true,
          details: {
            cn: `尝试使用活字印刷来制作你的印刷作品吧！`,
            en: `Let's try the traditional movable type printing to create your own piece! `,
          },
        },
        {
          stampIndex: 'kids-11',
          sectionIndexes: [11],
          name: '面部彩绘',
          nameEng: 'Face Painting',
          checkin: true,
          checkinCondition: {
            cn: `完成摊位活动`,
            en: `Complete booth activities`,
          },
          price: `成人$10，儿童$6`,
          includedInTicket: true,
          details: {
            cn: `志愿者将为您提供画脸服务。`,
            en: `We'll paint on your face! `,
          },
        },
        {
          stampIndex: 'kids-12',
          sectionIndexes: [12],
          name: 'LingoAce',
          nameEng: 'LingoAce',
          checkin: true,
          checkinCondition: {
            cn: `【无门槛】打卡摊位即可盖章`,
            en: `Just stop by to get stamped! `,
          },
          details: {
            cn: `🔥载歌载谷活动给朋友们送福利啦！<br/>
首次试听lingoace在线中文课或者新加坡数学课的家长！立刻领取价值$25amazon礼品卡一张哦！<br/>
LingoAce摊位给大家提供万圣节🎃专属礼品！一定要来哦，还可以享受新人福利代金券优惠哦！来摊位扫码立刻了解详情！
<br/><br/>
LingoAce是一家全球领先的在线中文教育平台，为4到15岁青少年儿童提供沉浸式的中文学习体验。我们致力于通过互动性强的多媒体课程和专业教师，激发孩子们对中文的兴趣，让学习变得有趣又高效。自2017年成立以来，LingoAce已在全球多个国家开设分支机构，服务遍布世界各地。`,
          },
        },
        {
          stampIndex: 'kids-13',
          sectionIndexes: [13],
          name: '太阳神美院',
          nameEng: 'Visionary Arts',
          checkin: true,
          checkinCondition: {
            cn: `完成摊位活动`,
            en: `Complete booth activities`,
          },
          details: {
            cn: `🌟太阳神美术学院 – 创意无限！儿童画展 和 义卖🎨<br/>
孩子们的梦想在纸上绽放，原创作品传递美好，和爱心！
<br/><br/>
🔥新生专属优惠🎉<br/>
游园会当天报名成为学员，立享$50-$100艺术品礼券，助力孩子开启艺术之旅，激发无限潜力！`,
          },
        },
        {
          stampIndex: 'kids-14',
          sectionIndexes: ['🎃'],
          name: '移动售卖',
          nameEng: 'Halloween Face Mask',
          checkin: false,
          price: '面具$3，帽子$5',
          details: {
            cn: `青蛙人挑担子售卖儿童面具和帽子。`,
            en: `Let's get ready for Halloween! We sell masks and hats for kids.`,
          },
        },
      ];
      const traditionsList = [
        {
          stampIndex: 'chinese-1',
          sectionIndexes: [1],
          name: '书法',
          nameEng: 'Calligraphy',
          checkin: true,
          free: true,
          checkinCondition: {
            cn: `完成摊位活动`,
            en: `Complete booth activities`,
          },
          includedInTicket: true,
          details: {
            cn: `书法练习，在灯笼上书写或绘画。`,
            en: `Let's practice calligraphy by writing and drawing on lanterns!`,
          },
        },
        {
          stampIndex: 'chinese-2',
          sectionIndexes: [2],
          name: '灯谜',
          nameEng: 'Lantern Riddles',
          checkin: true,
          free: true,
          checkinCondition: {
            cn: `完成摊位活动`,
            en: `Complete booth activities`,
          },
          includedInTicket: true,
          details: {
            cn: `自选3个灯谜，答对盖章。`,
            en: `Choose 3 lantern riddles, get a stamp if you got the correct answers.`,
          },
        },
        {
          stampIndex: 'chinese-3',
          sectionIndexes: [3],
          name: '诗词大会',
          nameEng: 'Poetry Party',
          checkin: true,
          free: true,
          checkinCondition: {
            cn: `完成摊位活动`,
            en: `Complete booth activities`,
          },
          includedInTicket: true,
          details: {
            cn: `飞花令，诗词抽签。`,
            en: `Fei Hua Ling & Poetry Lottery. `,
          },
        },
        {
          stampIndex: 'chinese-4',
          sectionIndexes: [4],
          name: '一游未尽桌游吧',
          nameEng: "Toby's Board Game Club",
          checkin: true,
          checkinCondition: {
            cn: `消费满$30`,
            en: `Spend more than $30`,
          },
          details: {
            en: `Toby’s Board Game Club offers a wide range of services to enhance your board game experience. Our knowledgeable staff can recommend and teach you games, and help you find partners to play with. We also offer selections of board games and blind boxes to purchase at the store.`,
          },
        },
        {
          stampIndex: 'chinese-5',
          sectionIndexes: [5],
          name: 'Cookie‘s Treat宠物烘焙',
          nameEng: "Cookie's Treat",
          checkin: true,
          checkinCondition: {
            cn: `消费满$30`,
            en: `Spend more than $30`,
          },
        },
        {
          stampIndex: 'chinese-6',
          sectionIndexes: [6],
          name: '24:01 Bloom & Craft',
          nameEng: '24:01 Bloom & Craft',
          checkin: true,
          checkinCondition: {
            cn: `消费满$30`,
            en: `Spend more than $30`,
          },
          details: {
            cn: `24:01 Bloom & Craft 是一家集鲜花、手工蜡烛、香水等多种手工艺品为一体的创意品牌。我们不仅提供高品质的手工艺品，每天还有各类Workshop，涵盖花艺设计、香薰蜡烛制作、香水调配等多种主题。通过互动式的体验，顾客可以亲自参与手作过程，享受创作的乐趣，并带回独一无二的作品。无论是寻找礼物还是想要丰富日常生活，我们的品牌都致力于为每一位顾客带来难忘的艺术体验`,
            en: `24:01 Bloom & Craft is a creative brand that blends the artistry of fresh flowers, handmade candles, perfumes, and a wide range of artisanal crafts. We not only offer premium, handcrafted products, but also host daily workshops covering diverse themes such as floral design, candle-making, and perfume blending. These interactive sessions allow customers to immerse themselves in the creative process, experiencing the joy of crafting while taking home a truly unique creation. Whether you’re searching for the perfect gift or looking to add a touch of artistry to everyday life, our brand is committed to delivering an inspiring and memorable experience for every customer.`,
          },
        },
        {
          stampIndex: 'chinese-7',
          sectionIndexes: [7],
          name: '茉茉手作',
          nameEng: 'Momo DIY Studio',
          checkin: true,
          checkinCondition: {
            cn: `消费满$5，并关注小红书或Ins账号`,
            en: `Spend more than $5, and follow us on RED or Instagram `,
          },
          details: {
            en: `Momo Handmade is a women-led local business where every day is an invitation to create, relax, and explore culture through the beauty of handcrafted art. We specialize in offering professional courses on intangible cultural heritage crafts, providing an extensive selection of premium materials and an inspiring environment for DIY projects. At Momo Handmade, we empower you to develop new skills, unwind from daily stresses, enhance your artistic sense, and connect with the rich traditions of craftsmanship. Embrace the joy of making something meaningful with us.`,
          },
        },
        {
          stampIndex: 'chinese-8',
          sectionIndexes: [8],
          name: 'Squishyverse',
          nameEng: 'Squishyverse',
          checkin: true,
          checkinCondition: {
            cn: `消费满$30`,
            en: `Spend more than $30`,
          },
        },
        {
          stampIndex: 'chinese-9',
          sectionIndexes: [9],
          name: '织月亮',
          nameEng: 'Kintamoon',
          checkin: true,
          checkinCondition: {
            cn: `消费满$30`,
            en: `Spend more than $30`,
          },
        },
        {
          stampIndex: 'chinese-10',
          sectionIndexes: [10],
          name: '天工坊',
          nameEng: 'Handmade Antique Workshop',
          checkin: true,
          checkinCondition: {
            cn: `完成摊位活动`,
            en: `Complete booth activities`,
          },
          price: '成人 $10，儿童 $3',
          includedInTicket: true,
          details: {
            cn: `1.成人区(14岁以上）-从工作人员处领取材料，开始创作。<br/>
      2.儿童区-工作人员协助小朋友进行制作。因胶枪热度，小朋友不可以单独进行制作。`,
            en: `1. Adults (>14 years of age) - Pick up materials from the staff and start creating.<br/>
      2. Children (<=14 years old) - Ask our staff for assistance. Participants need to be accompanied by our staff because of the glue gun's high temperature.`,
          },
        },
        {
          stampIndex: 'chinese-11',
          sectionIndexes: [11],
          name: 'JUSO居所休息空间',
          nameEng: 'JUSO Space',
          checkin: true,
          checkinCondition: {
            cn: `【无门槛】打卡摊位即可盖章`,
            en: `Just stop by to get stamped! `,
          },
          details: {
            cn: `Juso Home家居馆，现场礼品福利享不停！ <br/>
🎁 幸运轮盘大抽奖：超多精美家居好礼等你赢！<br/>
🛍️时尚购物袋：无门槛免费领取，来即是客！<br/>
🏠 家居空间体验角：近距离体验网红明星产品，自拍打卡墙！📸<br/>
🎟️ 专属代金券、独家折扣：轻松打造家居空间，省心又剩💰！`,
          },
        },
        {
          stampIndex: 'chinese-12',
          sectionIndexes: [12],
          name: '许愿墙',
          nameEng: 'Wishing Wall',
          checkin: true,
          free: true,
          checkinCondition: {
            cn: `完成摊位活动`,
            en: `Complete booth activities`,
          },
          includedInTicket: true,
          details: {
            cn: `许愿墙从工作人员处领取许愿卡，写下心愿或祈福。悬挂在指定地点。表达对未来的期望和祈愿。`,
            en: `A wishing wall allows participants to receive wishing cards from the staff, write down their wishes or prayers, and hang them in a designated area. This process expresses their hopes and blessings for the future.`,
          },
        },
        {
          stampIndex: 'chinese-13',
          sectionIndexes: [13],
          name: 'KissFingers穿戴甲',
          nameEng: 'KissFingers Press-on Nails',
          checkin: true,
          checkinCondition: {
            cn: `购买3件商品以上`,
            en: `Purchase more than 3 items`,
          },
          details: {
            en: `All hand made press on nails. Asian style. paint on nails. `,
          },
        },
        {
          stampIndex: 'chinese-14',
          sectionIndexes: [14],
          name: '汉服妆造',
          nameEng: 'Hanfu Styling - Makeup & Hair styling',
          checkin: true,
          checkinCondition: {
            cn: `完成摊位活动`,
            en: `Complete booth activities`,
          },
          details: {
            cn: `古风化妆，做古风发型。`,
            en: `Chinese traditional makeup and hair styling.`,
          },
        },
        {
          stampIndex: 'chinese-15',
          sectionIndexes: [15],
          name: 'Luckydodo',
          nameEng: 'Luckydodo',
          checkin: true,
          checkinCondition: {
            cn: `消费满$30`,
            en: `Spend more than $30`,
          },
        },
        {
          stampIndex: 'chinese-16',
          sectionIndexes: [16],
          name: 'AI汉服 & Story with AI',
          nameEng: 'AI Hanfu Photobook & Story with AI',
          checkin: true,
          checkinCondition: {
            cn: `消费满$30`,
            en: `Spend more than $30`,
          },
          details: {
            cn: `用AI定制汉服写真照 并打印成照片书`,
            en: `Get your AI fantasy image photobook with us! `,
          },
        },

        {
          stampIndex: 'chinese-17',
          sectionIndexes: [17],
          name: '拍照墙&古琴',
          nameEng: 'Photo Booth&Guqin',
          checkin: true,
          checkinCondition: {
            cn: `完成摊位活动`,
            en: `Complete booth activities`,
          },
          free: true,
          details: {
            cn: `可取任何服饰和道具进行拍照，每组限时3分钟。`,
            en: `Choose any costume / prop to take photos. Time limit: 3 minutes per group.`,
          },
        },
        {
          stampIndex: 'chinese-18',
          sectionIndexes: [18],
          name: 'Taro姻缘墙&戏谷剧团',
          nameEng: 'Taro Matching Corner & Valley Drama',
          checkin: true,
          checkinCondition: {
            cn: `完成摊位活动`,
            en: `Complete booth activities`,
          },
          price: '$10',
          includedInTicket: true,
          details: {
            cn: `【姻缘墙】单身朋友们在现场领取荷包，只要找到一样香包的异性，双方就可以一起获得精美小奖品！<br/>
【戏谷剧团】一桌麻将，两次人生，
三角关系，四个家庭，
戏谷年度黑色幽默喜剧《领带vs.高跟鞋》<br/>
12月14日、15日，Starbright theater，不见不散！`,
            en: `One table of mahjong,
Two lives reborn,
Three love triangles,
Four married couples.

Join us for Valley Drama’s dark comedy play:
“Necktie vs. High Heels”
December 14th & 15th at Starbright Theater. See you there!`,
          },
        },
        {
          stampIndex: 'chinese-19',
          sectionIndexes: [19],
          name: '糖画1',
          nameEng: 'Sugar Painting 1',
          checkin: true,
          checkinCondition: {
            cn: `完成摊位活动`,
            en: `Complete booth activities`,
          },
          price: '$6',
          includedInTicket: true,
          details: {
            cn: `自己创作或临摹底图，来创造独特的糖画吧！`,
            en: `Let's create your own sugar painting from scratch, or using the template we provide! `,
          },
        },
      ];
      const functionsList = [
        {
          stampIndex: 'function-1',
          sectionIndexes: [1],
          name: '志愿者休息/失物招领',
          nameEng: 'Volunteers/Lost & Found',
          checkin: false,
        },
        {
          stampIndex: 'function-2',
          sectionIndexes: [2],
          name: '古风面具',
          nameEng: 'Chinese Antique Masks',
          checkin: false,
        },
        {
          stampIndex: 'function-3',
          sectionIndexes: [3],
          name: '载歌在谷 - 云集',
          nameEng: 'ZGZGE - Cloud Clubs',
          checkin: true,
          checkinCondition: {
            cn: `关注载歌在谷公众号或小红书`,
            en: `Follow ZGZG on WeChat or RED`,
          },
          details: {
            cn: `【组织介绍】<br/> 云集是载歌在谷旗下各种社团的集合，运营组会协助大家定期举办团建活动，通过共同的兴趣爱好相互了解，一起搞事情😏🥰👏我们的四大社团分别是：<br/>
✅【职】挂云帆：职场分享类🧑‍💻💼<br/>
✅【书】影婆娑：读书观影📖🎬<br/>
✅体【娱】风云：体育娱乐类🏀🏹<br/>
✅一饱【演】福：文艺表演类🎵💃 <br/><br/>
【摊位活动】转盘游戏赢取礼品。如果需要“极速”参与，可以支付$1。`,
            en: `[About us] <br/> We are the gallery of activity clubs in ZGZG. Come to join us on weekends! We host a variety of Event - workplace skills-sharing seminars, book / movie nights, sports events, and musical performances. <br/>
[Activity] <br/> Spin to win special gifts! We offer fast pass for $1. `,
          },
        },
        {
          stampIndex: 'function-4',
          sectionIndexes: [4],
          name: '饭团',
          nameEng: 'Fantuan',
          checkin: true,
          checkinCondition: {
            cn: `【无门槛】打卡摊位即可盖章`,
            en: `Just stop by to get stamped! `,
          },
          details: {
            cn: `🧧饭团外卖新人注册即获得$100礼包
快来摊位套圈赢礼物🎁<br/>
🍙饭团毛绒发绳、零钱包、毛绒AirPods耳机套、斜挎包、大兔子玩偶<br/>
🆓还有1个月免费会员，7miles内免运费哦！<br/>
❤️快来饭团外卖开启惊喜时刻！`,
          },
        },
        {
          stampIndex: 'function-5',
          sectionIndexes: [5],
          name: 'Balanced & Better Family Financial Services',
          nameEng: 'Balanced & Better Family Financial Services',
          checkin: true,
          checkinCondition: {
            cn: `【无门槛】打卡摊位即可盖章`,
            en: `Just stop by to get stamped! `,
          },
          details: {
            cn: `Balanced & Better，专业理财规划，助您为孩子大学学费早做准备，实现安心无忧的早日退休！<br/><br/>
来摊位就有机会获得精美礼品🎁 <br/>
糖果🍬笔记本📒化妆袋👝陀螺玩具🪀 <br/>
先到先得！！！`,
            en: `✅Are you a HENRY (High Earning Not Rich Yet)?<br/>
✅Bothered by high tax burden and wonder about tax-free plans?<br/>
✅Wonder about ways of passive income?<br/>
✅Wonder how to plan for a “worry-free” retirement?<br/>
Balanced & Better Financial Service Team is here to help. We prepared candles, Canvas Makeup Bag, Inspirational notebooks, Unfinished Spinning Tops (kids painting) for the event
For your life, Balanced and Better!`,
          },
        },
        {
          stampIndex: 'function-6',
          sectionIndexes: [6],
          name: '老虎证券',
          nameEng: 'TradeUp',
          checkin: true,
          checkinCondition: {
            cn: `【无门槛】打卡摊位即可盖章`,
            en: `Just stop by to get stamped! `,
          },
          details: {
            cn: `开户豪礼！新人大礼包！<br/>
当天开户入金，领取高达5支【免费股票】，总价值最高可达$9,000;<br/>
入金500及以上赠送一股英伟达(NVDA)；<br/>
0佣金，0合约费*<br/>
无SSN也能轻松开户！
<br/><br/>
来摊位有更多礼品🎁（吉祥物小老虎玩偶🐯，雨伞☂️，Lamy联名笔🖊️）等您来领取！

TradeUP Securities, Inc.是老虎证券（Nasdaq: TIGR)在美国挂牌营业、有清算资质的证券公司，专注于为全球客户提供迅捷、高质量的证券交易执行、证券清算和全方位金融投资服务。
<br/>
----具体条款请参考摊位海报，相关T&C. `,
            en: `TradeUP Securities,Inc is a one-stop solution for securities trading, clearing, financing, serving both retail and institutional clients. Come to our booth to find more free stocks!`,
          },
        },
        {
          stampIndex: 'function-78',
          sectionIndexes: [7, 8],
          name: '游客签到处',
          nameEng: 'Visitor Checkin Center',
          checkin: false,
          details: {
            cn: `游玩指南<br/>
            本活动分为【载歌在谷自营】及【合作】两种摊位。支付方式不同，但均可盖章。<br/>
            载歌在谷自营摊位：<br/>
1）可购买$35的畅玩票，畅玩汉服妆造以外的全部载歌在谷自营摊位。成人套票价值$53；儿童套票价值$45。<br/>
2）或兑换“载歌在谷”游戏币，<br/>
游玩您喜欢的自营摊位。<br/>
            食品或手工艺品合作摊位：<br/>
直接向商家支付现金/转账/刷卡。`,
            en: `Join the activities! <br/>
            We provide [ZGZG-owned] and [Vendor] booths. Different payment methods, same stamp! <br/>
            To join the activities at ZGZG-owned booths: <br/>
1) Purchase or redeem <br/>
ZGZG-all-inclusive ticket ($35) <br/>
for all booths expect for Hanfu Styling. <br/>
The ZGZG-all-inclusive ticket worth $53 for adults, or $45 for children. <br/>
2) Or exchange for ZGZG tokens. Pay with token at each booth. <br/>
            Food/ handcraft Vendor booths: <br/>
Pay directly to the Vendor at the booth.`,
          },
        },
        {
          stampIndex: 'function-9',
          sectionIndexes: [9],
          name: 'HeCares急救站',
          nameEng: 'HeCares Integrative Medicine Center',
          checkin: true,
          checkinCondition: {
            cn: `【无门槛】打卡摊位即可盖章`,
            en: `Just stop by to get stamped! `,
          },
        },
        {
          stampIndex: 'function-10',
          sectionIndexes: [10],
          name: '糖画2',
          nameEng: 'Sugar Painting 2',
          checkin: true,
          checkinCondition: {
            cn: `完成摊位活动`,
            en: `Complete booth activities`,
          },
          price: '$6',
          includedInTicket: true,
          details: {
            cn: `自己创作或临摹底图，来创造独特的糖画吧！`,
            en: `Let's create your own sugar painting from scratch, or using the template we provide! `,
          },
        },
        {
          stampIndex: 'function-1112',
          sectionIndexes: [11, 12],
          name: '游客兑奖处',
          nameEng: 'Visitor Rewards Center provided by AAYA',
          checkin: false,
          details: {
            cn: `AAYA致力于为亚裔青少年提供一个服务平台，帮助他们发挥特长、展示才能，培养创造力和领导力，融入社会并服务社区。我们目前运营的项目包括：社区服务、爱心花园（The Giving Garden）、青少年记者（Junior Journalist）、小小艺术家（Young Artist）。我们的目标是提升孩子们的社会责任感和正义感，帮助改善亚裔青少年在西方社会的形象，增强他们的自信心和归属感。 此外，AAYA还为华裔家庭提供低价甚至免费的中文、英文、数学等课程，并鼓励高中生担任助教（Junior Teachers），帮助他们在教学中更深入地理解所学知识。 自2020年成立以来，AAYA于2021年正式注册为合法的501(c)(3)非营利组织，并获得了申请总统义工奖的资质。每年都有数十位热心公益的青少年和成年人通过我们的平台获得这一荣誉，彰显他们对社区服务的贡献与承诺。目前，我们的运作完全依赖家长的捐赠和义工老师们的无私奉献，欢迎社会各界的支持与帮助，助力我们的青少年社群实现更大的理想与目标，走得更远。`,
            en: `Asian American Youth Association (AAYA) is dedicated to providing a platform for Asian-American youth, helping them showcase their talents, develop creativity and leadership, integrate into society, and serve their community. Our current programs include: Community Service, The Giving Garden, Junior Journalist, and Young Artist. Our goal is to enhance the youth's sense of social responsibility and justice, improve the image of Asian-American youth in Western society, and boost their confidence and sense of belonging.
In addition, AAYA offers low-cost or even free courses in Chinese, English, and Math to Chinese-American families, while encouraging high school students to serve as Junior Teachers, helping them deepen their understanding of the subjects they teach.
Since its establishment in 2020, AAYA was officially registered as a legal 501(c)(3) nonprofit organization in 2021 and has earned the qualification to apply for the Presidential Volunteer Service Award. Every year, dozens of passionate youth and adults receive this honor through our platform, recognizing their dedication and commitment to community service. Currently, AAYA is entirely supported by donations from parents and the selfless contributions of volunteer teachers. We welcome support and assistance from all sectors of society to help our youth community achieve greater aspirations and move forward further.`,
          },
        },
        {
          stampIndex: 'function-13',
          sectionIndexes: [13],
          name: '方太',
          nameEng: 'Fotile',
          checkin: true,
          checkinCondition: {
            cn: `【无门槛】打卡摊位即可盖章`,
            en: `Just stop by to get stamped! `,
          },
          details: {
            cn: `静享无烟 安心省心 <br/>
中式烹饪 认准方太<br/>
到摊位即可获得方太购物袋1个<br/>
惊喜礼品 等你解锁<br/>
还有成套玥影购买代金券快乐优享`,
          },
        },
      ];

      const allBooths = [...cuisinesList, ...kidsList, ...traditionsList, ...functionsList];

      function generateBoothListHTML(boothList, sectionName) {
        const collectedStamps = Cookies.getJSON('collectedStamps');
        return boothList
          .map((booth) => {
            let stampStatus = '';
            if (booth.checkin && collectedStamps?.includes(booth.stampIndex)) {
              stampStatus = `<div class="booth-stamp-status booth-tag">✅</div>`;
            }
            const supportCheckin = booth.checkin
              ? `<div class="booth-tag" style="
                          color: rgb(206,15,4);
                          background: rgb(247,216,215);
                          border-radius: 4px;
                          width: 1.4rem;
                          height: 1.4rem;
                          text-align: center;
                          display: flex;
                          align-content: center;
                          justify-content: center;
                          align-items: center;
                      ">章</div>`
              : '';
            const includedInTicket = booth.includedInTicket
              ? `<div class="booth-tag" style="
                          color: rgb(156,88,2);
                          background: rgb(239,228,214);
                          border-radius: 4px;
                          width: 1.4rem;
                          height: 1.4rem;
                          text-align: center;
                          display: flex;
                          align-content: center;
                          justify-content: center;
                          align-items: center;
                      ">畅</div>`
              : '';
            const free = booth.free
              ? `<div class="booth-tag" style="
                          color: rgb(48,176,199);
                          background: rgb(222,242,246);
                          border-radius: 4px;
                          width: 1.4rem;
                          height: 1.4rem;
                          text-align: center;
                          display: flex;
                          align-content: center;
                          justify-content: center;
                          align-items: center;
                      ">免</div>`
              : '';

            const sectionIndexHtmls = booth.sectionIndexes
              .map((index) => {
                return `<div class="booth-number booth-section-${sectionName}">${index}</div>`;
              })
              .join('');
            const enNameTag =
              booth.nameEng && booth.name !== booth.nameEng
                ? `<div class="booth-name-en">${booth.nameEng}</div>`
                : '';

            return `<div class="booth-card" data-booth-name="${booth.name}">
                  ${sectionIndexHtmls}
                  <div class="booth-name">
                    <div class="booth-name-cn">${booth.name}</div>
                  ${enNameTag}
                  </div>
                  <div class="booth-tags">
                    ${stampStatus}
                    ${supportCheckin}
                    ${includedInTicket}
                    ${free}
                  </div>
                  <div style="height: 100%;
                        width: 1rem;
                        display: flex;
                        justify-content: center;
                        align-content: center;
                        align-items: center;
                        margin-right: 0.5rem;">
                    <img src="/images/2024-map/arrow.png" alt="" style="object-fit: contain;
          height: 1.2rem; transform: translate(0px, 2px);"/>
                  </div>
                  <div class="arrow"></div>
                </div>`;
          })
          .join('');
      }

      function openBoothDetails(e) {
        const boothName = e.currentTarget.getAttribute('data-booth-name');

        const selectedBooth = allBooths.find((b) => b.name === boothName);

        const cnNameHTML = `<div>${selectedBooth.name}</div>`;
        const enNameHTML =
          selectedBooth.nameEng && selectedBooth.name !== selectedBooth.nameEng
            ? `<div>${selectedBooth.nameEng}</div>`
            : '';

        let priceHTML = '';

        if (selectedBooth.price) {
          priceHTML = `
            <div style="display: flex;
              align-items: center;
              text-align: center;
              justify-content: center;">
              <div style="background: #893A2F;
                border-radius: 50%;
                color: white;
                width: 1.4rem;
                height: 1.4rem;
                display: flex;
                align-content: center;
                justify-content: center;
                align-items: center;
                margin-right: 5px;">
                N
              </div>
              <span style="color: #893A2F">代币支付: ${selectedBooth.price}</span>
            </div>
          `;
        }

        let checkinCondition = '';

        if (selectedBooth.checkin && selectedBooth.checkinCondition) {
          if (selectedBooth.checkinCondition.html) {
            checkinCondition = `
                <h3 style="text-align: center; margin-bottom: 10px;">打卡条件</h3>
                ${selectedBooth.checkinCondition.html}
                `;
          } else {
            checkinCondition = `
                <h3 style="text-align: center; margin-bottom: 10px;">打卡条件</h3>
                <p>${selectedBooth.checkinCondition.cn}</p>
                <p>${selectedBooth.checkinCondition.en}</p>
                `;
          }
        }

        const cnDetailsHTML = selectedBooth.details?.cn
          ? `<p class="booth-details">${selectedBooth.details.cn}</p>`
          : '';
        const enDetailsHTML = selectedBooth.details?.en
          ? `<p class="booth-details">${selectedBooth.details.en}</p>`
          : '';
        const boothDetailsTitleHTML =
          cnDetailsHTML || enDetailsHTML
            ? `<h3 style="text-align: center; width: 100%;">店铺简介</h3>`
            : '';

        boothDetailsEle.innerHTML = `
                <h2 style="width: 100%; text-align: center;">
                  ${cnNameHTML}
                  ${enNameHTML}
                </h2>
                <div id="boothDetailsScrollable" style="height: 55vh;
                    flex-wrap: wrap;
                    align-content: center;
                    justify-content: center;
                    align-items: center;
                    overflow: scroll;">
                    ${priceHTML}
                  <div style="width: 100%;text-align: center;">
                    ${checkinCondition}
                  </div>
                  <div class="booth-details-container">
                    ${boothDetailsTitleHTML}
                    ${cnDetailsHTML}
                    ${enDetailsHTML}
                  </div>
                </div>
                `;
        sectionNameEle.classList.add('display-none');
        boothDetailsEle.classList.remove('display-none');
        returnToBoothListBtn.classList.remove('display-none');
        boothListEle.classList.add('display-none');
        setTimeout(() => {
          document.querySelector('#boothDetailsScrollable').scrollTop = -20;
        }, 0);
      }

      function returnToBoothList() {
        setTimeout(() => {
          document.querySelector('#boothDetailsScrollable').scrollTop = -20;
        }, 0);
        sectionNameEle.classList.remove('display-none');
        boothDetailsEle.classList.add('display-none');
        boothListEle.classList.remove('display-none');
        returnToBoothListBtn.classList.add('display-none');
        boothDetailsEle.scrollTop = 0;
      }
    </script>

    <!-- 生成二维码 -->
    <script>
      function generateQR() {
        const phone = Cookies.get('phone');
        const url = `https://zgzg.io/stamp?phone=${phone}`;
        if (siteStates.qrCodeEle) {
          return;
        } else {
          const ele = document.createElement('DIV');
          new QRCode(ele, {
            text: url,
            width: 200,
            height: 200,
            colorDark: '#151515',
            colorLight: '#ffffff',
            correctLevel: QRCode.CorrectLevel.H,
          });
          siteStates.qrCodeEle = ele;
        }
      }
    </script>

    <!-- 打开打卡记录弹窗及获取打卡信息 -->
    <script type="module">
      import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.14.0/firebase-app.js';
      import {
        collection,
        query,
        where,
        getDocs,
        getFirestore,
      } from 'https://www.gstatic.com/firebasejs/10.14.0/firebase-firestore.js';

      const firebaseConfig = {
        apiKey: 'AIzaSyA32iYcPDmH7MJLFKpadSkUuR4K3avEYeA',
        authDomain: 'zgzg-9e6d0.firebaseapp.com',
        projectId: 'zgzg-9e6d0',
        storageBucket: 'zgzg-9e6d0.appspot.com',
        messagingSenderId: '807744488876',
        appId: '1:807744488876:web:bf6ddbfe0b5ab49f216609',
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);

      // const db = getFirestore(app);
      window.firebaseQueryFn = query;
      window.getDocs = getDocs;
      window.firebaseCollection = collection;
      window.firebaseWhere = where;
      window.firebaseStore = getFirestore(app);
    </script>

    <!-- CSS resetting 和 全局 class -->
    <style>
      body {
        padding: 0;
        margin: 0;
        overflow: hidden;
        height: 0;
        background-color: #ffeeab;
        font-family: sans-serif;
        /* 防止 iOS safari 缩放 */
        touch-action: pan-x pan-y;
      }

      .display-block {
        display: block !important;
      }

      .display-none {
        display: none !important;
      }
      .btn-close {
        position: absolute;
        right: 0.5rem;
        top: 1rem;
        height: 2rem;
        width: 2rem;
        background: white;
        display: flex;
        justify-content: center;
        align-items: center;
        border-radius: 50%;
        font-size: 1.5rem;
        font-weight: bolder;
        text-align: center;
        vertical-align: middle;
      }

      .btn-close-ios-safari {
        display: inline-block;
        vertical-align: top;
      }
    </style>

    <!-- Map Styles -->
    <style>
      #map-container {
        max-width: 100vw;
        /* max-height: calc(100vh - env(safe-area-inset-bottom)); */
        width: 100vw;
        /* height: calc(100vh - env(safe-area-inset-bottom)); */
        overflow: hidden;
      }
      #map {
        width: 100%;
        object-fit: contain;
        /* height: 100%; */
      }
    </style>

    <!-- Drawer Styles -->
    <style>
      #drawer {
        z-index: 100;
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        background: white;
        border-top-left-radius: 1rem;
        border-top-right-radius: 1rem;
        box-shadow: 0px -3px 27px 14px #0000007d;
      }

      #drawer-slider-container {
        display: flex;
        justify-content: center;
      }

      #drawer-slider {
        width: 65px;
        height: 7px;
        border-radius: 8px;
        margin-top: 5px;
        border: none;
      }

      .drawer-tab-group {
        display: flex;
        justify-content: space-between;
        margin: 1rem 1rem 0 1rem;
      }

      .drawer-tab {
        padding: 0.5rem 1.3rem;
        border-radius: 8px;
        min-width: 4rem;
        display: flex;
        justify-content: center;
        background-color: #ffd400;
      }

      .drawer-tab__active {
        background-color: #ffd400;
      }

      .drawer-tab__inactive {
        background-color: rgb(253, 254, 198);
      }

      .drawer-content__container {
        margin: 1rem 1rem 0 1rem;
        overflow-y: scroll;
        max-height: 60vh;
      }

      #drawer-content {
        animation-fill-mode: forwards;
        height: 3vh;
        /* width: 100vw; */
      }

      #drawer-content > * {
        max-width: 100%;
      }

      .drawer-open {
        animation-name: slideUp;

        animation-duration: 0.2s;
        animation-timing-function: ease-out;
      }

      .drawer-close {
        animation-name: slideDown;

        animation-duration: 0.2s;
        animation-timing-function: ease-out;
      }

      @keyframes slideUp {
        from {
          height: 3vh;
        }

        to {
          height: 60vh;
        }
      }

      @keyframes slideDown {
        from {
          height: 60vh;
        }

        to {
          height: 3vh;
        }
      }
    </style>

    <!-- 节目单 样式 -->
    <style>
      .show-info-card {
        position: relative;
      }
      .show-time {
        padding: 1rem 0;
        font-size: 1.5rem;
        font-weight: bold;
      }

      .show-info {
        left: 0;
        right: 0;
        height: 150px;
        backdrop-filter: grayscale(60%);
        position: absolute;
      }
      .show-title {
        font-size: 2rem;
        margin: 0.5rem;
      }
      .show-intro {
        margin: 0.5rem;
      }
      img.show-bg-img {
        object-fit: cover;
        width: 100%;
        height: 150px;
        border-radius: 0.5rem;
      }

      ul.show-list {
        background: #edf4f7;
        border-radius: 8px;
        padding-right: 0.5rem;
        padding-top: 32px;
        padding-bottom: 0.5rem;
        padding-inline-start: 2rem;
        margin-top: 0;
      }
      ul.show-list li {
        margin-bottom: 16px;
      }
      .show-list-time {
        margin-bottom: 0.5rem;
        margin-top: 24px;
      }

      .lottery-info {
        background: #edf4f7;
        border-radius: 8px;
        padding: 32px 16px;
        /* padding-top: 32px; */
      }
      .lottery-info h4 {
        margin: 0;
        color: #ce0f04;
      }
      .lottery-info p {
        margin: 0.5rem 0;
      }
      .lottery-info ol {
        margin: 0;
      }
    </style>

    <!-- Sponsors Tab Styles -->
    <style>
      .sponsor-tab-group {
        display: flex;
        justify-content: space-between;
        /* margin-top: 1rem; */
        position: fixed;
        /* width: 100%; */
        z-index: 100;
        background: white;
        padding: 2px;
        left: 1rem;
        right: 1rem;
        border: 1px solid #f5be00;
        border-radius: 8px;
      }
      #sponsorTabContainer {
        margin-top: 3rem;
      }

      .sponsor-tab {
        padding: 0.5rem 1rem;
        border-radius: 8px;
        min-width: 4rem;
        display: flex;
        justify-content: center;
        background-color: #ffd400;
        width: 40%;
      }

      .sponsor-tab__active {
        background-color: #ffd400;
      }

      .sponsor-tab__inactive {
        background-color: rgb(253, 254, 198);
      }

      .sponsor-container {
        /* margin: 1rem 1rem 0 1rem; */
        overflow-y: scroll;
      }

      #sponsorLogoGroup {
        /* width: 500px; */
        /* height: 100px; */
        white-space: nowrap;
        position: relative;
        overflow-x: scroll;
        overflow-y: hidden;
        margin-top: 1rem;
      }
      .sponsor-logo {
        /* width: 100px; */
        /* background-color: #eee; */
        /* float: none; */
        /* height: 100px; */
        margin: 0 0.5rem;
        display: inline-block;
        /* zoom: 1; */
        position: relative;
      }

      .sponsor-logo img.logo-img {
        width: 100%;
        height: 100%;
        object-fit: contain;
        opacity: 0.6;
        -moz-opacity: 0.6; /* Firefox and Mozilla browsers */
        -webkit-opacity: 0.6;
      }

      .logo-container {
        /* border-radius: 100%; */
        /* border: 5px solid transparent; */
        padding: 3px;
        /* filter: opacity(0.5); */
        width: 100%;
        height: 100%;
      }

      .tier-platinum {
        width: 150px;
        height: 150px;
      }

      .tier-gold {
        width: 100px;
        height: 100px;
      }

      .tier-collaborator {
        width: 50px;
        height: 50px;
      }

      input.active-selected-sponsor {
        position: absolute;
        left: 0;
        top: 0;

        z-index: 1;
        opacity: 0;
        display: block;
      }

      input.active-selected-sponsor:checked + .logo-container > .logo-img {
        opacity: 1;
        -moz-opacity: 1; /* Firefox and Mozilla browsers */
        -webkit-opacity: 1;
      }

      img.tire-icon {
        position: absolute;
        width: 20px;
        height: 20px;
        right: 0;
        bottom: 0;
        z-index: 50;
      }

      img.sponsor-qr {
        width: 100%;
        object-fit: contain;
      }
    </style>

    <!-- 打卡入口样式 -->
    <style>
      .checkin-button-container {
        position: absolute;
        top: -62px;
        left: 0;
        right: 0;
        display: flex;
        height: 50px;
        justify-content: space-evenly;
      }

      .checkin-button {
        background: linear-gradient(45deg, rgba(240, 220, 220), rgb(254, 247, 216));
        border-radius: 8px;
        width: 90%;
        display: flex;
        align-items: center;
      }

      .checkin-button-logo {
        object-fit: contain;
        height: 80%;
        margin-right: 10px;
        margin-left: 10px;
      }

      #showCheckinHistory,
      #showQRCode {
        background: linear-gradient(45deg, rgba(240, 220, 220), rgb(254, 247, 216));
        border-radius: 8px;
        width: 45%;
        display: flex;
        align-items: center;
      }
    </style>

    <!-- 打卡记录弹窗样式 -->
    <style>
      #checkinHistoryPopup {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        background: linear-gradient(180deg, #ffe1b4, white);
        height: 80%;
        z-index: 200;
        border-top-left-radius: 8px;
        border-top-right-radius: 8px;
        box-shadow: 0px -68px 66px 27px #0000007d;
      }

      #checkinHistoryPopup h1 {
        text-align: center;
      }

      #checkinHistoryPopup p {
        text-align: center;
      }

      #rewardRedeemedMark {
        height: 100%;
        width: 100%;
        position: absolute;
        z-index: -1;
        backdrop-filter: blur(5px);
      }

      .stamp-cards-list {
        display: grid;
        padding: 0;
        justify-content: center;
        overflow-y: scroll;
        height: 70%;
        grid-template-columns: 40% 40%;
        gap: 10px;
        align-items: start;
        justify-items: center;
      }

      .stamp-card {
        position: relative;
        width: 100%;
        height: 125px;
        display: flex;
        /* align-content: center; */
        justify-content: center;
        align-items: center;
      }

      .stamp-name {
        font-size: 1.2rem;
        font-weight: bolder;
        text-align: center;
        justify-items: center;
      }

      .stamp-card img {
        position: absolute;
        bottom: 1rem;
        right: 0;
        width: 5rem;
        opacity: 0.7;
      }
    </style>

    <!-- 输入手机号样式 -->
    <style>
      #registerPopup {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        background: linear-gradient(180deg, #ffe1b4, white);
        height: 50%;
        z-index: 200;
        border-top-left-radius: 8px;
        border-top-right-radius: 8px;
        box-shadow: 0px -68px 66px 27px #0000007d;
      }

      #registerPopup h1 {
        text-align: center;
      }
    </style>

    <!-- 二维码弹窗样式 -->
    <style>
      #qrCodePopup {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        background: linear-gradient(180deg, #ffe1b4, white);
        height: 50%;
        z-index: 200;
        border-top-left-radius: 8px;
        border-top-right-radius: 8px;
        box-shadow: 0px -68px 66px 27px #0000007d;
      }

      #qrCodePopup h1 {
        text-align: center;
        margin-bottom: 0.2rem;
      }
      #qrCodePopup p {
        text-align: center;
        margin-top: 0;
      }

      #qrCodeContainer {
        display: flex;
        justify-content: center;
        align-items: center;
      }
    </style>

    <!-- 摊位列表样式 -->
    <style>
      #boothListPopup {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        background: linear-gradient(180deg, #ffe1b4, white);
        height: 80%;
        z-index: 200;
        border-top-left-radius: 8px;
        border-top-right-radius: 8px;
        box-shadow: 0px -68px 66px 27px #0000007d;
      }

      #boothListPopup h1 {
        text-align: center;
      }
      #boothList {
        display: flex;
        flex-direction: column;
        align-items: center;
        overflow-y: scroll;
        height: 80%;
        padding-top: 1rem;
      }

      #boothDetails {
        padding: 0 1rem;
      }
      .booth-details-container {
        padding-bottom: 1rem;
      }

      #returnToBoothListBtn {
        position: absolute;
        top: 1rem;
        left: 0.5rem;
        width: 1rem;
        height: 1rem;
        padding: 0.5rem;
        background-color: white;
        border-radius: 50%;
      }

      #returnToBoothListBtn img {
        width: 100%;
        height: 100%;
        object-fit: contain;
        -moz-transform: scale(-1, -1);
        -o-transform: scale(-1, -1);
        -webkit-transform: scale(-1, -1);
        transform: scale(-1, -1);
      }
      .booth-card {
        margin-bottom: 1rem;
        border-radius: 8px;
        /* border: 1px black solid; */
        width: 90%;
        display: flex;
        align-items: center;
        background: white;
        box-shadow: 0px 0px 7px 0px #ddd;
      }
      .booth-number {
        width: 2rem;
        height: 2rem;
        display: flex;
        justify-content: center;
        align-items: center;
        margin: 10px;
        margin-right: 0;
        border-radius: 8px;
        color: white;
        font-weight: bold;
        flex-shrink: 0;
      }
      .booth-name {
        display: flex;
        flex-wrap: wrap;
        align-items: flex-start;
        margin-left: 10px;
        margin-right: 10px;
        flex-direction: column;
      }
      .booth-name-cn,
      .booth-name-en {
        width: 100%;
      }
      .booth-stamp-status {
        margin-left: auto;
      }

      .booth-tags {
        display: flex;
        justify-content: center;
        align-items: center;
        margin-left: auto;
        margin-right: 0.5rem;
      }
      .booth-tag {
        height: 100%;
        margin-right: 0.3rem;
      }

      .booth-section-cuisine {
        background-color: #ff9500;
      }
      .booth-section-kids {
        background-color: #008c41;
      }
      .booth-section-traditions {
        background-color: #007aff;
      }
      .booth-section-functions {
        background-color: #ff2d55;
      }
    </style>

    <!-- 中英文切换文本设定  -->
    <script>
      const i18nStrings = {
        'payInfo.coin': {
          zh: '代币支付',
          en: 'Coin',
        },
        'payInfo.cash': {
          zh: '现金支付',
          en: 'Cash',
        },
        langSwitch: {
          zh: 'English',
          en: '中文',
        },
        'drawer.tab.guide': {
          zh: '游园指南',
          en: 'Guide',
        },
        'drawer.tab.shows': {
          zh: '节目单',
          en: 'Shows',
        },
        'drawer.tab.guide.sponsors': {
          zh: '赞助&合作',
          en: 'Sponsors',
        },
      };
    </script>

    <!-- 节目单信息 -->
    <script>
      const showsList = [
        {
          title: '演出标题',
          intro:
            '演出简介，没错，就是简介。一两句话，一两行的那种。演出简介，没错，就是简介。一两句话，一两行的那种。',
          time: '12:00 PM',
          image: '/images/2024-map/content.png',
        },
        {
          title: '演出标题',
          intro:
            '演出简介，没错，就是简介。一两句话，一两行的那种。演出简介，没错，就是简介。一两句话，一两行的那种。',
          time: '12:00 PM',
          image: '/images/2024-map/content.png',
        },
        {
          title: '演出标题',
          intro:
            '演出简介，没错，就是简介。一两句话，一两行的那种。演出简介，没错，就是简介。一两句话，一两行的那种。',
          time: '12:00 PM',
          image: '/images/2024-map/content.png',
        },
        {
          title: '演出标题',
          intro:
            '演出简介，没错，就是简介。一两句话，一两行的那种。演出简介，没错，就是简介。一两句话，一两行的那种。',
          time: '12:00 PM',
          image: '/images/2024-map/content.png',
        },
      ];
    </script>

    <!-- 顶层 tab 动态内容 html -->
    <script>
      const tourGuideHTMLContent = `
      <img
              src="/images/2024-map/tourGuide.png"
              alt=""
              style="border-radius: 8px; margin-bottom: 1rem;"
            /> 
      `;
      // const showListHTMLContent = showsList
      //   .map((show) => {
      //     return `
      //   <div class="show-list-container">
      //         <div class="show-info-card">
      //           <div class="show-time">
      //             <span>${show.time}</span>
      //           </div>
      //           <div class="show-info">
      //             <div class="show-title">${show.title}</div>
      //             <div class="show-intro">
      //               ${show.intro}
      //             </div>
      //           </div>
      //           <img class="show-bg-img" src="${show.image}" alt="" />
      //         </div>
      //       </div>
      //   `;
      //   })
      //   .join('');
      const showListHTMLContent = `<div class="show-list-card">
              <h3 class="show-list-time">12:50 PM - 3:40 PM</h3>
              <ul class="show-list">
                <li>祥狮欢舞迎金秋 | Leland High School Lion Dance Team</li>
                <li>Batter Up | Twinkle by Tingna Dance Studio</li>
                <li>Woman Up | Extremer</li>
                <li>弦樂團金曲串燒 Rhapsody String Ensemble | 狂响弦乐团</li>
                <li>Put your records on | Aevum Mistry</li>
                <li>舞蹈串烧《穿越》 | DD舞团</li>
                <li>是妈妈是女儿 | Zoe and Jade Worden</li>
                <li>国乐雅秋 The Fall Melody by Guqin, Bamboo flute and Hulusi | 雅韵国乐社</li>
                <li>少林雄风 | Shaolin Warrior Martial Arts</li>
                <li>华夏有衣-汉服走秀 Chinese Dress Fashion Show | 硅谷汉服社</li>
                <li>古琴演奏 | 太玄古琴社</li>
                <li>传承 | Song's Kung Fu</li>
                <li>儿童舞蹈《花木兰》《森林圆舞曲》《奇妙的小仙子 》| Dream Hope Star Dance Academy</li>
                <li>越剧清唱《追鱼》 | Xiaowen Geng</li>
                <li>舞蹈 - 红昭愿 | 85Fun Studio</li>
                <li>月光+蝶 | 丁梦</li>
                <li>中提琴独奏《渔舟唱晚》 | 黄佳艺</li>
                <li>中英文歌曲串烧 Mashup | 兰兰</li>

              </ul>
            </div>
            <div class="show-list-card">
              <h3 class="show-list-time">4:10 pm - 4:40 pm</h3>
              <ul class="show-list">
                <li>Band: Why So Serious</li>
              </ul>
            </div>
            <div class="show-list-card">
              <h3 class="show-list-time">4:40 pm - 5:10 pm</h3>
              <div class="lottery-info">
                <h4>舞台抽奖 Lottery!</h4>
                <p>
                  Join the Stage lottery to win the grand prize worth
                  <span style="color: #ce0f04; font-weight: bold">$719!</span>
                </p>
                <p style="font-weight: bold">可通过以下方式获取抽奖券，以参与舞台抽奖：</p>
                <ol>
                  <li>购买售价$35的畅玩券赠送3张；</li>
                  <li>提前24小时注册活动赠送1张。</li>
                </ol>
                <p style="font-weight: bold">
                  How to obtain stage lottery tickets to join the stage lottery? 
                </p>
                <ol>
                  <li>Purchase ZGZG-all inclusive ticket ($35) - 3 tickets</li>
                  <li>Register 24 hours before event start (before Oct 19 2024, PST 12pm)</li>
                </ol>
              </div>
            </div>
            <div class="show-list-card">
              <h3 class="show-list-time">5:10 pm - 5:40 pm</h3>
              <ul class="show-list">
                <li>特邀嘉宾：走起乐队 Special Guest: StartUp Band</li>
              </ul>
            </div>
            <div style="padding-bottom: 1rem; text-align: center; color: rgb(92, 92, 92)">
              Produced by 载歌在谷
            </div>
            `;

      const sponsorsHTMLContent = `
      <div class="sponsor-container">
              <div class="sponsor-tab-group" id="sponsorTabGroup">
                <div
                  class="sponsor-tab sponsor-tab__active"
                  id="sponsorTab0"
                  data-i18n-label="sponsor.tab.guide"
                >
                  赞助商
                </div>
                <div
                  class="sponsor-tab sponsor-tab__inactive"
                  id="sponsorTab1"
                  data-i18n-label="sponsor.tab.shows"
                >
                  友情合作
                </div>
              </div>
              <div id="sponsorTabContainer">
                <div id="sponsorLogoGroup">
                </div>
              </div>
              <div id="sponsorDetailsContainer"></div>
            </div>`;
    </script>
  </head>
  <body>
    <div>
      <!-- 测试按钮 -->
      <button
        onclick="function clearCookies() {Cookies.remove('redeemed'); Cookies.remove('phone'); Cookies.remove('collectedStamps')} clearCookies()"
        style="position: absolute; top: 0; left: 0"
      >
        删除登记信息(上线前移除)
      </button>

      <div
        style="
          z-index: 1000;
          position: absolute;
          top: 5px;
          right: 5px;
          background: white;
          padding: 8px;
          display: flex;
          align-items: center;
          border-radius: 8px;
        "
      >
        <img src="/images/2024-map/feedback.png" alt="" style="width: 1rem; margin-right: 5px" />
        <a
          href="https://docs.google.com/document/d/16ux3i3IZh-Gz1s2OXWIVjh_q2N2Wa-0QfH4-AlMfGfg/edit?tab=t.i0hgrn6djcx0"
          target="_blank"
          style="text-decoration: none"
          >Feedback(链接待更新)</a
        >
      </div>

      <!-- <div id="top-info">
        <div id="pay-info">
          <span data-i18n-label="payInfo.coin"> </span>
          <span data-i18n-label="payInfo.cash"> </span>
        </div>
        <div id="change-lang">
          <span data-i18n-label="langSwitch"> </span>
        </div>
      </div> -->
      <div id="map-container">
        <img id="map" alt="" />
      </div>

      <div id="registerPopup" class="display-none">
        <div id="registerPopupCloseBtn" class="btn-close">×</div>
        <h1>输入手机号</h1>
        <p style="margin: 0 2rem 1rem 2rem">
          输入手机号来获取您的专属二维码。可以用来在支持的摊位进行打卡。收集打卡记录可以换取礼品。
        </p>
        <div style="justify-content: center; display: flex">
          <input
            id="phoneNumber"
            type="tel"
            pattern="[0-9]{10}"
            required
            placeholder="格式：1234567890"
            autocomplete="off"
            style="height: 2rem; width: 100%; margin: 0 2rem; border-radius: 8px"
          />
        </div>
        <div style="display: flex; margin-top: 1rem; justify-content: center">
          <button
            id="confirmPhone"
            disabled
            style="
              font-size: 1rem;
              padding-top: 5px;
              padding-bottom: 5px;
              margin: 0 4rem;
              background: #ffd400;
              border: 1px #f5be00 solid;
              width: 100%;
              border-radius: 8px;
            "
          >
            确认
          </button>
        </div>
      </div>

      <div id="checkinHistoryPopup" class="display-none">
        <div id="checkinHistoryPopupCloseBtn" class="btn-close">×</div>
        <h1>打卡记录</h1>

        <div>
          <p>
            您已经收集了
            <span id="stampCount" style="color: #c72c34; font-weight: bold">0</span>
            处打卡点
          </p>
          <p>凭打卡记录在兑奖处领奖</p>
        </div>

        <div id="rewardRedeemedMark" class="display-none">
          <img
            src="/images/2024-map/redeemed.png"
            alt=""
            style="
              position: absolute;
              object-fit: contain;
              width: 70vw;
              margin: auto;
              left: 0;
              right: 0;
              top: 3rem;
              transform: rotate(-25deg);
            "
          />
        </div>

        <div class="stamp-cards-list" id="stampCardsList"></div>
      </div>

      <div id="boothListPopup" class="display-none">
        <div id="boothListPopupCloseBtn" class="btn-close">×</div>
        <div id="returnToBoothListBtn" class="display-none">
          <img src="/images/2024-map/arrow.png" alt="" />
        </div>
        <h1 id="sectionName"></h1>
        <div id="boothList"></div>
        <div id="boothDetails"></div>
      </div>

      <div id="qrCodePopup" class="display-none">
        <div id="qrCodePopupCloseBtn" class="btn-close">×</div>
        <h1>我的二维码</h1>
        <p>使用的手机号：<span id="registeredPhone"></span></p>
        <div id="qrCodeContainer"></div>
      </div>

      <div id="drawer">
        <div class="checkin-button-container" id="checkinButtonContainer"></div>

        <!-- 显示打卡页面 -->
        <div id="drawer-slider-container">
          <button id="drawer-slider"></button>
        </div>
        <div class="drawer-tab-group" id="drawerTabGroup">
          <div
            class="drawer-tab drawer-tab__active"
            id="drawerTab0"
            data-i18n-label="drawer.tab.guide"
          >
            游园指南
          </div>
          <div
            class="drawer-tab drawer-tab__inactive"
            id="drawerTab1"
            data-i18n-label="drawer.tab.shows"
          >
            节目单
          </div>
          <div
            class="drawer-tab drawer-tab__inactive"
            id="drawerTab2"
            data-i18n-label="drawer.tab.guide.sponsors"
          >
            赞助&合作
          </div>
        </div>
        <div class="drawer-content__container">
          <div id="drawer-content">
            <img
              src="/images/2024-map/tourGuide.png"
              alt="游园指南"
              style="border-radius: 8px; margin-bottom: 1rem"
            />
          </div>
        </div>
      </div>
    </div>
  </body>

  <script>
    var userAgent = window.navigator.userAgent;

    if (userAgent.match(/iPad/i) || userAgent.match(/iPhone/i)) {
      // iPad or iPhone
      document.querySelectorAll('.btn-close')?.forEach((node) => {
        node.classList.add('btn-close-ios-safari');
      });
    } else {
      // Anything else
    }
  </script>

  <!-- 获取全局 DOM -->
  <script>
    // Drawer 抽屉
    const drawerEle = document.querySelector('#drawer');
    const drawerSliderEle = document.querySelector('#drawer-slider');
    const drawerContentEle = document.querySelector('#drawer-content');
    const drawerTabGroupEle = document.querySelector('#drawerTabGroup');

    // 弹窗
    const boothListPopupEle = document.querySelector('#boothListPopup');
    const checkinHistoryPopupEle = document.querySelector('#checkinHistoryPopup');
    const registerPopupEle = document.querySelector('#registerPopup');
    const qrCodePopupEle = document.querySelector('#qrCodePopup');

    // 摊位相关
    const boothListEle = document.querySelector('#boothList');
    const boothListPopupCloseBtnEle = document.querySelector('#boothListPopupCloseBtn');
    const sectionNameEle = document.querySelector('#sectionName');
    const boothDetailsEle = document.querySelector('#boothDetails');
    const returnToBoothListBtnEle = document.querySelector('#returnToBoothListBtn');
  </script>

  <!-- 中英切换 -->
  <!-- <script>
    const allI18nEles = document.querySelectorAll('[data-i18n-label]');

    allI18nEles.forEach((e) => {
      const i18nLabel = e.getAttribute('data-i18n-label');

      e.innerHTML = i18nStrings[i18nLabel][siteStates.selectedLanguage];
    });
  </script> -->
  <!-- 摊位信息弹窗 -->
  <script>
    // boothListEle.onclick = (e) => {
    //   openBoothDetails(e);
    // };

    boothListPopupCloseBtnEle.onclick = () => {
      closePopup(boothListPopupEle);
      // 返回列表状态
      sectionNameEle.classList.add('display-block');
      sectionNameEle.classList.remove('display-none');
      document.querySelector('#boothDetails')?.classList.add('display-none');
      document.querySelector('#returnToBoothListBtn')?.classList.add('display-none');
      document.querySelector('#boothList')?.classList.remove('display-none');
    };

    returnToBoothListBtnEle.onclick = returnToBoothList;
  </script>
  <!-- pan zoom map script -->
  <script>
    class TouchDragEvent {
      maxScale = 5;
      minScale = 1;
      initialWidth;
      initialHeight;
      initialLeft;
      initialTop;

      translateXLeftLimit;
      translateYUpperLimit = 0;

      translateXRightLimit = 0;
      translateYLowerLimit = 0;

      preTouchPosition = {};
      translateX = 0;
      translateY = 0;
      scaleRatio = 1;
      scaleOrigin = {
        x: 0,
        y: 0,
      };
      preTouchesClientx1y1x2y2;
      originHaveSet = false;

      img;
      naturalWidth;
      naturalHeight;

      area = {
        cuisine: {
          left: 0,
          right: 0,
          top: 0,
          bottom: 0,
        },
      };

      constructor(img) {
        this.img = img;
        img.src = mapURL;
        img.onload = () => {
          this.calculateInitialSize();

          this.reset();
          this.naturalWidth = this.img.naturalWidth;
          this.naturalHeight = this.img.naturalHeight;
          this.area = {
            cuisine: {
              left: 170 / this.naturalWidth,
              top: 340 / this.naturalHeight,
              right: 351 / this.naturalWidth,
              bottom: 442 / this.naturalHeight,
            },
            kids: {
              left: 228 / this.naturalWidth,
              top: 485 / this.naturalHeight,
              right: 483 / this.naturalWidth,
              bottom: 588 / this.naturalHeight,
            },
            traditions1: {
              left: 104 / this.naturalWidth,
              top: 633 / this.naturalHeight,
              right: 544 / this.naturalWidth,
              bottom: 698 / this.naturalHeight,
            },
            traditions2: {
              left: 525 / this.naturalWidth,
              top: 446 / this.naturalHeight,
              right: 635 / this.naturalWidth,
              bottom: 626 / this.naturalHeight,
            },
            functions1: {
              left: 154 / this.naturalWidth,
              top: 741 / this.naturalHeight,
              right: 518 / this.naturalWidth,
              bottom: 805 / this.naturalHeight,
            },
            functions2: {
              left: 519 / this.naturalWidth,
              top: 315 / this.naturalHeight,
              right: 622 / this.naturalWidth,
              bottom: 420 / this.naturalHeight,
            },
          };
          // console.log('this.area', JSON.stringify(this.area));
          // console.log('initialWidth', this.initialWidth);
          // console.log('initialHeight', this.initialHeight);
          // console.log('naturalWidth', this.naturalWidth);
          // console.log('naturalHeight', this.naturalHeight);
        };

        img.ontouchstart = this.onTouchstart.bind(this);
        img.ontouchmove = this.onTouchmove.bind(this);
        img.ontouchend = this.onTouchend.bind(this);
        img.ontouchcancel = this.ontouchcancel.bind(this);

        img.onclick = this.onClick.bind(this);
      }

      calculateInitialSize() {
        if (this.naturalWidth < this.naturalHeight) {
          this.setDisplaySize(
            screen.width,
            (screen.width / this.naturalWidth) * this.naturalHeight
          );
        } else if (this.naturalWidth > this.naturalHeight) {
          this.setDisplaySize(
            (screen.width / this.naturalHeight) * this.naturalWidth,
            screen.width
          );
        } else {
          this.setDisplaySize(screen.width, screen.width);
        }
      }

      setDisplaySize(width, height) {
        this.initialWidth = width;
        this.initialHeight = height;

        if (this.initialWidth >= 280) {
          this.initialLeft = -(this.initialWidth - 280) / 2;
        }

        if (this.initialHeight >= 280) {
          this.initialTop = -(this.initialHeight - 280) / 2;
        }
      }

      reset() {
        this.translateXLeftLimit = 0;
        this.translateYUpperLimit = 0;

        this.translateXRightLimit = 0;
        this.translateYLowerLimit = 0;

        this.preTouchPosition = {};
        this.translateX = 0;
        this.translateY = 0;
        this.scaleRatio = 1;
        this.scaleOrigin = {
          x: 0,
          y: 0,
        };
        this.preTouchesClientx1y1x2y2 = undefined;
        this.originHaveSet = false;
        this.setStyle('transform', 'none');
        this.setStyle('transform-origin', '50% 50%');
      }

      onClick(e) {
        if (siteStates.isDrawerOpen) {
          drawerContentEle.className = 'drawer-close';
          siteStates.isDrawerOpen = false;
          return;
        }

        // 如果有打开的弹窗（不是顶层抽屉），不响应地图点击
        if (siteStates.hasPopupOpen) {
          closePopup(boothListPopupEle);

          // 如果是在摊位详情中，返回列表
          document.querySelector('#boothDetails')?.classList.add('display-none');
          document.querySelector('#returnToBoothListBtn')?.classList.add('display-none');
          document.querySelector('#boothList')?.classList.remove('display-none');

          // 摊位详情会隐藏分区标题
          sectionNameEle.classList.add('display-block');
          sectionNameEle.classList.remove('display-none');

          closePopup(registerPopupEle);
          closePopup(checkinHistoryPopupEle);
          closePopup(registerPopupEle);
          closePopup(qrCodePopupEle);
          return;
        }

        // offsetX 和 offsetY 不会随着缩放平移而变化，可以根据这俩来确定点了哪里。但是不能直接用，因为图片显示的尺寸不同屏幕不一样，得按照百分比算
        const x = e.offsetX;
        const y = e.offsetY;

        const xPercent = x / this.img.clientWidth;
        const yPercent = y / this.img.clientHeight;

        // console.log('offsetX', e.offsetX);
        // console.log('offsetY', e.offsetY);
        // console.log('xPercent', xPercent);
        // console.log('yPercent', yPercent);
        // console.log('initialWidth', this.initialWidth);
        // console.log('initialHeight', this.initialHeight);
        // console.log('this.img.clientHeight', this.img.clientHeight);
        // console.log('this.img.clientWidth', this.img.clientWidth);

        if (
          xPercent >= this.area.cuisine.left &&
          xPercent <= this.area.cuisine.right &&
          yPercent >= this.area.cuisine.top &&
          yPercent <= this.area.cuisine.bottom
        ) {
          showBoothListPopupFunc('cuisine');
        } else if (
          xPercent >= this.area.kids.left &&
          xPercent <= this.area.kids.right &&
          yPercent >= this.area.kids.top &&
          yPercent <= this.area.kids.bottom
        ) {
          showBoothListPopupFunc('kids');
        } else if (
          (xPercent >= this.area.traditions1.left &&
            xPercent <= this.area.traditions1.right &&
            yPercent >= this.area.traditions1.top &&
            yPercent <= this.area.traditions1.bottom) ||
          (xPercent >= this.area.traditions2.left &&
            xPercent <= this.area.traditions2.right &&
            yPercent >= this.area.traditions2.top &&
            yPercent <= this.area.traditions2.bottom)
        ) {
          showBoothListPopupFunc('traditions');
        } else if (
          (xPercent >= this.area.functions1.left &&
            xPercent <= this.area.functions1.right &&
            yPercent >= this.area.functions1.top &&
            yPercent <= this.area.functions1.bottom) ||
          (xPercent >= this.area.functions2.left &&
            xPercent <= this.area.functions2.right &&
            yPercent >= this.area.functions2.top &&
            yPercent <= this.area.functions2.bottom)
        ) {
          showBoothListPopupFunc('functions');
        }
      }

      // @HostListener('touchstart', ['$event'])
      onTouchstart(e) {
        let touches = e.touches;
        if (touches.length > 1) {
          let one = touches['0'];
          let two = touches['1'];
          this.preTouchesClientx1y1x2y2 = [one.clientX, one.clientY, two.clientX, two.clientY];
          this.originHaveSet = false;
        }
        this.recordPreTouchPosition(touches['0']);
      }

      // @HostListener('touchmove', ['$event'])
      onTouchmove(e) {
        let touches = e.touches;

        if (touches.length === 1) {
          let oneTouch = touches['0'];
          let translated = this.getTranslate(oneTouch.target);
          this.translateX = oneTouch.clientX - this.preTouchPosition.x + translated.left;
          this.translateY = oneTouch.clientY - this.preTouchPosition.y + translated.top;

          this.limitImageBorder();

          if (this.scaleRatio !== 1) {
            let matrix = `matrix(${this.scaleRatio}, 0, 0, ${this.scaleRatio}, ${this.translateX}, ${this.translateY})`;
            this.setStyle('transform', matrix);
          }

          this.recordPreTouchPosition(oneTouch);
        } else {
          let one = touches['0'];
          let two = touches['1'];
          this.scaleRatio =
            (this.distance(one.clientX, one.clientY, two.clientX, two.clientY) /
              this.distance(...this.preTouchesClientx1y1x2y2)) *
              this.scaleRatio || 1;
          if (this.scaleRatio > this.maxScale) {
            this.scaleRatio = this.maxScale;
          }
          if (this.scaleRatio < this.minScale) {
            this.scaleRatio = this.minScale;
          }

          if (!this.originHaveSet) {
            this.originHaveSet = true;
            // 移动视线中心
            let origin = this.relativeCoordinate(
              (one.clientX + two.clientX) / 2,
              (one.clientY + two.clientY) / 2,
              this.img.getBoundingClientRect()
            );
            // 修正视野变化带来的平移量
            this.translateX =
              (this.scaleRatio - 1) * (origin.x - this.scaleOrigin.x) + this.translateX;
            this.translateY =
              (this.scaleRatio - 1) * (origin.y - this.scaleOrigin.y) + this.translateY;

            this.setStyle('transform-origin', `${origin.x}px ${origin.y}px`);
            this.scaleOrigin = origin;
          }

          this.limitImageBorder();
          let matrix = `matrix(${this.scaleRatio}, 0, 0, ${this.scaleRatio}, ${this.translateX}, ${this.translateY})`;
          this.setStyle('transform', matrix);
          this.preTouchesClientx1y1x2y2 = [one.clientX, one.clientY, two.clientX, two.clientY];
        }
        e.preventDefault();
      }

      // 触摸点离开时更新最后位置
      // @HostListener('touchend', ['$event'])
      onTouchend(e) {
        let touches = e.touches;
        if (touches.length === 1) {
          this.recordPreTouchPosition(touches['0']);
        }
        if (this.scaleRatio === 1) {
          this.reset();
        }
      }

      // @HostListener('touchcancel', ['$event'])
      ontouchcancel(e) {
        let touches = e.touches;
        if (touches.length === 1) {
          this.recordPreTouchPosition(touches['0']);
        }
        if (this.scaleRatio === 1) {
          this.reset();
        }
      }

      limitImageBorder() {
        this.translateXLeftLimit = (this.scaleRatio - 1) * this.scaleOrigin.x - this.initialLeft; // 已正确
        this.translateXRightLimit =
          -(this.scaleRatio - 1) * (this.initialWidth - this.scaleOrigin.x) + this.initialLeft;

        this.translateYUpperLimit = (this.scaleRatio - 1) * this.scaleOrigin.y - this.initialTop; // 已正确
        this.translateYLowerLimit =
          -(this.scaleRatio - 1) * (this.initialHeight - this.scaleOrigin.y) + this.initialTop; // 已正确

        if (this.translateY > this.translateYUpperLimit) {
          this.translateY = this.translateYUpperLimit;
        } else if (this.translateY < this.translateYLowerLimit) {
          this.translateY = this.translateYLowerLimit;
        }

        if (this.translateX > this.translateXLeftLimit) {
          this.translateX = this.translateXLeftLimit;
        } else if (this.translateX < this.translateXRightLimit) {
          this.translateX = this.translateXRightLimit;
        }
      }

      getStyle(target, style) {
        let styles = window.getComputedStyle(target, null);
        return styles.getPropertyValue(style);
      }

      getTranslate(target) {
        let matrix = this.getStyle(target, 'transform');
        let nums = matrix.substring(7, matrix.length - 1).split(', ');
        let left = parseInt(nums[4]) || 0;
        let top = parseInt(nums[5]) || 0;
        return {
          left: left,
          top: top,
        };
      }

      recordPreTouchPosition(touch) {
        this.preTouchPosition = {
          x: touch.clientX,
          y: touch.clientY,
        };
      }

      relativeCoordinate(x, y, rect) {
        let cx = (x - rect.left) / this.scaleRatio;
        let cy = (y - rect.top) / this.scaleRatio;
        return {
          x: cx,
          y: cy,
        };
      }

      setStyle(key, value) {
        this.img.style[key] = value;
      }

      distance(x1, y1, x2, y2) {
        let a = x1 - x2;
        let b = y1 - y2;
        return Math.sqrt(a * a + b * b);
      }
    }

    // 使用方法
    let imgElement = document.querySelector('#map'); // 选择需要绑定事件的图片元素
    new TouchDragEvent(imgElement);
  </script>

  <!-- drawer script -->
  <script>
    let isDrawerOpen = false;

    function toggleDrawer() {
      siteStates.isDrawerOpen = !siteStates.isDrawerOpen;

      if (siteStates.isDrawerOpen) {
        drawerContentEle.className = 'drawer-open';
      } else {
        drawerContentEle.className = 'drawer-close';
      }
    }

    function openDrawer() {
      siteStates.isDrawerOpen = true;

      drawerContentEle.className = 'drawer-open';
      drawerContentEle.parentNode.scrollTop = 0;
    }

    drawerSliderEle.onclick = toggleDrawer;
    drawerTabGroup.onclick = openDrawer;
  </script>

  <!-- 顶层切换tab -->
  <script>
    const tourTab = document.querySelector('#drawerTabGroup > #drawerTab0');
    const showListTab = document.querySelector('#drawerTabGroup > #drawerTab1');
    const sponsorsTab = document.querySelector('#drawerTabGroup > #drawerTab2');
    const tabContainer = document.querySelector('#drawer-content');

    tourTab.onclick = () => {
      tourTab.classList.remove('drawer-tab__inactive');
      tourTab.classList.add('drawer-tab__active');

      showListTab.classList.add('drawer-tab__inactive');
      showListTab.classList.remove('drawer-tab__active');

      sponsorsTab.classList.add('drawer-tab__inactive');
      sponsorsTab.classList.remove('drawer-tab__active');
      tabContainer.innerHTML = tourGuideHTMLContent;
      drawerContentEle.parentNode.scrollTop = 0;
    };

    showListTab.onclick = () => {
      showListTab.classList.remove('drawer-tab__inactive');
      showListTab.classList.add('drawer-tab__active');

      tourTab.classList.add('drawer-tab__inactive');
      tourTab.classList.remove('drawer-tab__active');

      sponsorsTab.classList.add('drawer-tab__inactive');
      sponsorsTab.classList.remove('drawer-tab__active');

      tabContainer.innerHTML = showListHTMLContent;
      drawerContentEle.parentNode.scrollTop = 0;
    };

    sponsorsTab.onclick = () => {
      sponsorsTab.classList.remove('drawer-tab__inactive');
      sponsorsTab.classList.add('drawer-tab__active');

      tourTab.classList.add('drawer-tab__inactive');
      tourTab.classList.remove('drawer-tab__active');

      showListTab.classList.add('drawer-tab__inactive');
      showListTab.classList.remove('drawer-tab__active');

      tabContainer.innerHTML = sponsorsHTMLContent;
      drawerContentEle.parentNode.scrollTop = 0;

      bindSponsorTabEvents();
    };
  </script>

  <!-- 赞助商子tab切换 -->
  <script>
    function showSponsorInfo(sponsorKey, sponsorDetailsContainer) {
      const qrImages = sponsorsAndCollaboratorsMap[sponsorKey].qrCode
        .map((code) => {
          return `<img class="sponsor-qr" src="${code}"/>`;
        })
        .join('');
      sponsorDetailsContainer.innerHTML = `
        <div style="margin-bottom: 1rem;">
          <p class="sponsor-details">${sponsorsAndCollaboratorsMap[sponsorKey].details ?? ''}</p>
          ${qrImages}
        </div>
        `;
    }
    function selectSponsor(e, sponsorDetailsContainer) {
      if (e.target.classList.contains('logo-img')) {
        const sponsorKey = e.target.getAttribute('data-sponsor');
        let inputEle;

        for (let item of e.target.parentNode.parentNode.children) {
          if (item.nodeName === 'INPUT') {
            inputEle = item;
          }
        }
        inputEle.checked = true;
        showSponsorInfo(sponsorKey, sponsorDetailsContainer);
      }
    }
    function bindSponsorTabEvents() {
      const sponsorTab1 = document.querySelector('#sponsorTabGroup > #sponsorTab0');
      const sponsorTab2 = document.querySelector('#sponsorTabGroup > #sponsorTab1');
      const sponsorLogoGroup = document.querySelector('#sponsorLogoGroup');
      const sponsorDetailsContainer = document.querySelector('#sponsorDetailsContainer');

      function activateTab1() {
        sponsorTab1.classList.remove('sponsor-tab__inactive');
        sponsorTab1.classList.add('sponsor-tab__active');

        sponsorTab2.classList.add('sponsor-tab__inactive');
        sponsorTab2.classList.remove('sponsor-tab__active');

        sponsorLogoGroup.innerHTML = sponsorsListHTML;
        sponsorLogoGroup.scrollLeft = 0;

        document.querySelectorAll('.active-selected-sponsor').checked = true;

        sponsorLogoGroup.onclick = (e) => {
          selectSponsor(e, sponsorDetailsContainer);
        };
        showSponsorInfo(sponsorsList[0], sponsorDetailsContainer);
      }

      function activateTab2() {
        sponsorTab2.classList.remove('sponsor-tab__inactive');
        sponsorTab2.classList.add('sponsor-tab__active');

        sponsorTab1.classList.add('sponsor-tab__inactive');
        sponsorTab1.classList.remove('sponsor-tab__active');

        sponsorLogoGroup.innerHTML = collaboratorsListHTML;
        sponsorLogoGroup.scrollLeft = 0;

        sponsorLogoGroup.onclick = (e) => {
          selectSponsor(e, sponsorDetailsContainer);
        };
        showSponsorInfo(collaboratorsList[0], sponsorDetailsContainer);
      }

      activateTab1();

      sponsorTab1.onclick = activateTab1;

      sponsorTab2.onclick = activateTab2;
    }
  </script>

  <!--打卡记录弹窗，注册生成二维码 -->
  <script>
    const registeredCheckinButtonsHTML = `<div class="checkin-button" id="showCheckinHistory">
            <img class="checkin-button-logo" src="/images/2024-map/zgzglogo.png" alt="" />
            查看打卡记录
          </div>
          <div class="checkin-button" id="showQRCode">
            <img class="checkin-button-logo" style="height: 76%;" src="/images/2024-map/my-qr-code.png" alt="" />
            我的二维码
          </div>`;
    const unregisteredCheckinButtonsHTML = `<div class="checkin-button" id="checkinButton">
            <img class="checkin-button-logo"  src="/images/2024-map/zgzglogo.png" alt="" />
            登记以获取打卡二维码
            <img src="/images/2024-map/arrow.png" alt="" style="object-fit: contain;
    height: 1.2rem;
    transform: translate(0px, 2px);
    margin-left: auto;
    margin-right: 1rem;"/>
          </div>`;

    const stampCardsListEle = document.querySelector('#stampCardsList');
    const stampCountEle = document.querySelector('#stampCount');

    const confirmPhoneEle = document.querySelector('#confirmPhone');
    const phoneEle = document.querySelector('#phoneNumber');

    function showCheckinhistory() {
      if (Cookies.get('phone')) {
        openStampPopup();
        // 更新摊位列表中打卡信息
        cuisinesListHTML = generateBoothListHTML(cuisinesList, sectionNames.cuisine);
        kidsListHTML = generateBoothListHTML(kidsList, sectionNames.kids);
        traditionsListHTML = generateBoothListHTML(traditionsList, sectionNames.traditions);
        functionsListHTML = generateBoothListHTML(functionsList, sectionNames.functions);
      } else {
        openPopup(registerPopupEle);
      }
    }

    if (Cookies.get('phone')) {
      generateQR();
      document.querySelector('#checkinButtonContainer').innerHTML = registeredCheckinButtonsHTML;

      if (document.querySelector('#showQRCode')) {
        document.querySelector('#showQRCode').onclick = () => {
          document.querySelector('#registeredPhone').innerHTML = Cookies.get('phone');
          openPopup(qrCodePopupEle);
        };
        document.querySelector('#showCheckinHistory').onclick = showCheckinhistory;

        document.querySelector('#qrCodeContainer').appendChild(siteStates.qrCodeEle);
      }
    } else {
      document.querySelector('#checkinButtonContainer').innerHTML = unregisteredCheckinButtonsHTML;
      document.querySelector('#checkinButton').onclick = () => {
        openPopup(registerPopupEle);
      };
    }

    async function openStampPopup() {
      const phone = Cookies.get('phone');
      const query = window.firebaseQueryFn(
        window.firebaseCollection(window.firebaseStore, 'stamps'),
        window.firebaseWhere('phone', '==', phone)
      );
      const querySnapshot = await window.getDocs(query);

      const stampCards = [];
      const collectedStamps = new Set();

      querySnapshot.forEach((doc) => {
        const boothIndex = doc.data().booth;
        // [
        //   'cuisine-2',
        //   'cuisine-3',
        //   'cuisine-4',
        //   'cuisine-6',
        //   'kids-1',
        //   'kids-2',
        //   'kids-3',
        //   'kids-10',
        //   'function-1112',
        // ].forEach((doc) => {
        //   const boothIndex = doc;

        if (boothIndex === 'function-1112') {
          Cookies.set('redeemed', '1');
          // 不要在打卡列表里显示兑奖摊位
          return;
        }

        collectedStamps.add(boothIndex);
        const booth = allBooths.find((booth) => booth.stampIndex === boothIndex);

        const boothNameHTML = stampCards.push(`<div class="stamp-card">
          <div class="stamp-name">
            <div>${booth?.name}</div>  
            <div>${booth?.nameEng && booth.nameEng !== booth?.name ? booth.nameEng : ''}</div>  
          </div>
          <img src="/images/2024-map/zgzglogo.png" alt="" />
        </div>`);
      });

      Cookies.set('collectedStamps', Array.from(collectedStamps));
      stampCountEle.innerHTML = stampCards.length;
      stampCardsListEle.innerHTML = stampCards.join('');
      if (Cookies.get('redeemed') === '1') {
        document.querySelector('#rewardRedeemedMark').classList.remove('display-none');
        document.querySelector('#rewardRedeemedMark').classList.add('display-block');
      }
      openPopup(checkinHistoryPopupEle);
    }

    function register() {
      if (phoneEle.checkValidity()) {
        Cookies.set('phone', phoneEle.value);
        generateQR();
        document.querySelector('#checkinButtonContainer').innerHTML = registeredCheckinButtonsHTML;
        document.querySelector('#showCheckinHistory').onclick = showCheckinhistory;
        alert('注册成功，请点击主界面“我的二维码”按钮查看');

        closePopup(registerPopupEle);
        document.querySelector('#showQRCode').onclick = () => {
          document.querySelector('#registeredPhone').innerHTML = Cookies.get('phone');
          openPopup(qrCodePopupEle);
        };

        document.querySelector('#qrCodeContainer').appendChild(siteStates.qrCodeEle);
      } else {
        alert('请输入手机号');
      }
    }

    function validatePhone(e) {
      phoneEle.checkValidity();

      if (phoneEle.checkValidity()) {
        confirmPhoneEle.disabled = false;
      } else {
        confirmPhoneEle.disabled = true;
      }
    }

    document.querySelector('#checkinHistoryPopupCloseBtn').onclick = () => {
      closePopup(checkinHistoryPopupEle);
    };
    document.querySelector('#registerPopupCloseBtn').onclick = () => {
      closePopup(registerPopupEle);
    };
    document.querySelector('#qrCodePopupCloseBtn').onclick = () => {
      closePopup(qrCodePopupEle);
    };
    confirmPhoneEle.onclick = register;
    phoneEle.onblur = validatePhone;
    phoneEle.oninput = validatePhone;
  </script>
</html>
